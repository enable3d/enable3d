{"version":3,"sources":["webpack://ENABLE3D/webpack/universalModuleDefinition","webpack://ENABLE3D/webpack/bootstrap","webpack://ENABLE3D/external \"THREE\"","webpack://ENABLE3D/../common/dist/logger.js","webpack://ENABLE3D/./node_modules/eventemitter3/index.js","webpack://ENABLE3D/../common/dist/extendedObject3D.js","webpack://ENABLE3D/../common/dist/defaultMaterial.js","webpack://ENABLE3D/../common/dist/extendedMesh.js","webpack://ENABLE3D/../common/dist/physicsLoader.js","webpack://ENABLE3D/../common/dist/types.js","webpack://ENABLE3D/../common/dist/serverClock.js","webpack://ENABLE3D/(webpack)/buildin/global.js","webpack://ENABLE3D/../common/dist/applyMixins.js","webpack://ENABLE3D/../common/dist/factories.js","webpack://ENABLE3D/../common/dist/wasmLoader.js","webpack://ENABLE3D//home/yannick/enable3d/node_modules/timers-browserify/main.js","webpack://ENABLE3D//home/yannick/enable3d/node_modules/setimmediate/setImmediate.js","webpack://ENABLE3D//home/yannick/enable3d/node_modules/process/browser.js","webpack://ENABLE3D//home/yannick/enable3d/node_modules/events/events.js","webpack://ENABLE3D/./src/convexObjectBreaker.ts","webpack://ENABLE3D/./src/physicsBody.ts","webpack://ENABLE3D/./src/shapes.ts","webpack://ENABLE3D/./src/constraints.ts","webpack://ENABLE3D/./src/events.ts","webpack://ENABLE3D/./src/debugDrawer.ts","webpack://ENABLE3D/./src/physics.ts","webpack://ENABLE3D/./src/three-to-ammo.js","webpack://ENABLE3D/./src/torusShape.ts","webpack://ENABLE3D/./src/lib/Clock.ts","webpack://ENABLE3D/./src/index.ts","webpack://ENABLE3D/./src/bundle.ts"],"names":["root","factory","exports","module","require","define","amd","window","__WEBPACK_EXTERNAL_MODULE__0__","installedModules","__webpack_require__","moduleId","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","default","msg","console","error","has","prefix","Events","EE","fn","context","once","this","addListener","emitter","event","TypeError","listener","evt","_events","push","_eventsCount","clearEvent","EventEmitter","__proto__","eventNames","events","names","slice","getOwnPropertySymbols","concat","listeners","handlers","length","ee","Array","listenerCount","emit","a1","a2","a3","a4","a5","args","len","arguments","removeListener","undefined","apply","j","on","removeAllListeners","off","prefixed","extendStatics","__extends","b","setPrototypeOf","__","constructor","__importDefault","mod","index_1","logger_1","ExtendedObject3D","_super","_this","vector3","Vector3","hasBody","anims","currentAnimation","id","theta","worldTheta","phi","worldPhi","configurable","getWorldDirection","Math","atan2","x","z","acos","y","setAction","_a","mixer","action","clipAction","time","stopAllAction","fadeIn","play","Object3D","DefaultMaterial","_defaultMaterial","MeshLambertMaterial","color","ExtendedMesh","geometry","material","Mesh","wasmLoader_1","PhysicsLoader","path","callback","__loadPhysics","Ammo","then","extendedObject3D_1","extendedMesh_1","AnimationMixer","AnimationClip","AnimationAction","Material","Line","Points","Group","ServerClock","ms","autoStart","tickLengthMs","previousTick","Date","now","actualTicks","_delta","_isRunning","start","startTime","loop","stop","isRunning","getDelta","getElapsedTime","onTick","cb","setTimeout","setImmediate","g","Function","e","derivedCtor","baseCtors","forEach","baseCtor","getOwnPropertyNames","getOwnPropertyDescriptor","__assign","assign","__rest","indexOf","propertyIsEnumerable","defaultMaterial_1","Factories","scene","isHeadless","defaultMaterial","plane","planeConfig","materialConfig","makePlane","box","boxConfig","makeBox","sphere","sphereConfig","makeSphere","cylinder","cylinderConfig","makeCylinder","cone","coneConfig","makeCone","torus","torusConfig","makeTorus","extrude","extrudeConfig","makeExtrude","mesh","addMesh","existing","addExisting","addPlane","addBox","ground","groundConfig","addGround","addSphere","addCylinder","addCone","addTorus","addExtrude","addMaterial","_i","add","isArray","createMesh","position","obj","_b","_c","type","set","castShadow","receiveShadow","shape","autoCenter","breakable","bufferGeometry","rest","_d","depth","_e","bevelEnabled","ExtrudeBufferGeometry","ExtrudeGeometry","center","PlaneBufferGeometry","width","height","widthSegments","heightSegments","PlaneGeometry","side","DoubleSide","SphereBufferGeometry","radius","phiStart","phiLength","thetaStart","thetaLength","SphereGeometry","BoxBufferGeometry","depthSegments","BoxGeometry","rotateX","MathUtils","degToRad","CylinderBufferGeometry","radiusTop","radiusBottom","radiusSegments","openEnded","CylinderGeometry","ConeBufferGeometry","PI","TorusBufferGeometry","tube","radialSegments","tubularSegments","arc","TorusGeometry","keys","MeshBasicMaterial","basic","MeshNormalMaterial","normal","MeshStandardMaterial","standard","lambert","MeshPhongMaterial","phong","physical","MeshPhysicalMaterial","MeshToonMaterial","toon","LineBasicMaterial","line","PointsMaterial","points","custom","wasmSupported","WebAssembly","instantiate","module_1","Module","Uint8Array","of","Instance","loadScriptAsync","url","doneCallback","tag","document","createElement","onload","onerror","Error","async","src","head","appendChild","self","Timeout","clearFn","_id","_clearFn","scope","clearTimeout","setInterval","clearInterval","timeout","close","unref","ref","enroll","item","msecs","_idleTimeoutId","_idleTimeout","unenroll","_unrefActive","active","_onTimeout","global","clearImmediate","registerImmediate","html","channel","messagePrefix","onGlobalMessage","nextHandle","tasksByHandle","currentlyRunningATask","doc","attachTo","getPrototypeOf","toString","process","handle","nextTick","runIfPresent","postMessage","importScripts","postMessageIsAsynchronous","oldOnMessage","onmessage","canUsePostMessage","MessageChannel","port1","data","port2","documentElement","script","onreadystatechange","removeChild","random","source","addEventListener","attachEvent","task","run","cachedSetTimeout","cachedClearTimeout","defaultSetTimout","defaultClearTimeout","runTimeout","fun","currentQueue","queue","draining","queueIndex","cleanUpNextTick","drainQueue","marker","runClearTimeout","Item","array","noop","title","browser","env","argv","version","versions","prependListener","prependOnceListener","binding","cwd","chdir","dir","umask","ReflectOwnKeys","R","Reflect","ReflectApply","target","receiver","ownKeys","NumberIsNaN","Number","isNaN","init","_maxListeners","defaultMaxListeners","checkListener","_getMaxListeners","that","_addListener","prepend","warning","newListener","unshift","warned","w","String","count","warn","onceWrapper","fired","wrapFn","_onceWrap","state","wrapped","_listeners","unwrap","evlistener","arr","ret","unwrapListeners","arrayClone","copy","arg","RangeError","setMaxListeners","getMaxListeners","doError","er","err","message","handler","list","originalListener","shift","index","pop","spliceOne","rawListeners","v1","physics","ammo","offset","errors","checkCollisions","collided","didUpdate","_emitUpdateEvents","_needUpdate","tmpEuler","tmpQuaternion","tmpBtVector3","btVector3","tmpBtQuaternion","btQuaternion","setupEventEmitter","eventEmitter","need","onUpdateEvent","updateCallback","update","collision","collisionCallback","onCollision","bodies","transform","tmpTrans","getMotionState","getWorldTransform","refresh","setWorldTransform","setRotation","q","setFromEuler","setValue","ammoQuat","getRotation","qx","qy","qz","qw","angle","sqrt","setPosition","getOrigin","getLinearVelocity","getAngularVelocity","setVelocity","setLinearVelocity","setVelocityX","velocity","setVelocityY","setVelocityZ","setAngularVelocity","setAngularVelocityX","angularVelocity","setAngularVelocityY","setAngularVelocityZ","applyForce","applyCentralImpulse","applyForceX","applyForceY","applyForceZ","setCollisionFlags","getCollisionFlags","setRestitution","setBounciness","setFriction","setLinearFactor","setAngularFactor","setCcdMotionThreshold","threshold","setCcdSweptSphereRadius","objectsAmmo","config","mass","collisionFlags","translateX","lock","body","targetBody","fixed","spring","slider","hinge","coneTwist","targetPivot","pointToPoint","getTransform","bodyTransform","getCenterOfMassTransform","inverse","op_mul","targetTransform","btTransform","setIdentity","constraint","btGeneric6DofConstraint","zero","setLinearLowerLimit","setLinearUpperLimit","setAngularLowerLimit","setAngularUpperLimit","physicsWorld","addConstraint","btFixedConstraint","stiffness","damping","angularLock","btGeneric6DofSpringConstraint","enableSpring","setStiffness","setDamping","btSliderConstraint","setLowerLinLimit","setUpperLinLimit","pivot","axis","targetAxis","pivotV3","targetPivotV3","axisV3","targetAxisV3","btHingeConstraint","pivotTransform","btConeTwistConstraint","btPoint2PointConstraint","addCollider","object1","object2","eventCallback","AmmoDebugConstants","world","options","debugDrawMode","drawOnTop","maxBufferSize","vertices","Float32Array","colors","setAttribute","setUsage","vertexColors","depthTest","renderOrder","frustumCulled","enabled","debugDrawer","DebugDrawer","drawLine","drawContactPoint","reportErrorWarning","draw3dText","setDebugMode","getDebugMode","setDebugDrawer","enable","disable","remove","attributes","needsUpdate","debugDrawWorld","setDrawRange","from","to","heap","HEAPF32","fromX","fromY","fromZ","setXYZ","toX","toY","toZ","pointOnB","normalOnB","distance","_lifeTime","dx","dy","dz","warningString","Pointer_stringify","warnedOnce","_location","_textString","debugMode","ConvexObjectBreaker","minSizeForBreak","smallDelta","tempLine1","tempPlane1","tempPlane2","tempPlane_Cut","tempCM1","tempCM2","tempVector3","tempVector3_2","tempVector3_3","tempVector3_P0","tempVector3_P1","tempVector3_P2","tempVector3_N0","tempVector3_N1","tempVector3_AB","tempVector3_CB","tempResultObjects","segments","prepareBreakableObject","isBufferGeometry","userData","clone","subdivideByImpact","pointOfImpact","maxRadialIterations","maxRandomIterations","debris","addVectors","setFromCoplanarPoints","maxTotalIterations","subdivideRadial","subObject","startAngle","endAngle","numIterations","constant","sub","applyAxisAngle","cutByPlane","obj1","obj2","output","coords","normals","numPoints","numFaces","indices","getIndex","getVertexIndex","faceIdx","vert","idx","points1","points2","delta","numPointPairs","p0","p1","n0","n1","b1","c1","b2","c2","dot","localPlane","updateMatrix","transformPlaneToLocalSpace","matrix","va","vb","vc","segment","i0","i1","mark0","distanceToPoint","mark1","end","intersection","intersectLine","segmentedObject1","segmentedObject2","newMass","radius1","numPoints1","divideScalar","max","radius2","numPoints2","numObjects","quaternion","transformFreeVector","v","elements","transformFreeVectorInverse","transformTiedVectorInverse","resultPlane","referencePoint","coplanarPoint","rigidBodies","earlierDetectedCollisions","destroy","ptr","values","removeRigidBody","splice","setup","convexBreaker","objectsToRemove","numObjectsToRemove","setupPhysicsWorld","updateDebugger","gravity","collisionConfiguration","btDefaultCollisionConfiguration","dispatcher","btCollisionDispatcher","broadphase","btDbvtBroadphase","solver","btSequentialImpulseConstraintSolver","btDiscreteDynamicsWorld","setGravity","createDebrisFromBreakableObject","parent","fragmentDepth","removeDebris","impactPoint","impactNormal","detectedCollisions","deltaTime","stepSimulation","maxSubSteps","fixedTimeStep","il","objThree","isKinematicObject","needUpdate","getWorldQuaternion","getWorldPosition","tmpVector3","setOrigin","contactPoint","impulse","pos","vel","angVel","fragment","contactManifold","getManifoldByIndexInternal","getBody0","body0","castObject","btRigidBody","body1","getBody1","ptr0","ptr1","threeObject0","threeObject1","breakable0","breakable1","collided0","collided1","checkCollisions0","checkCollisions1","sort","find","el","combinedName","contact","maxImpulse","jl","getNumContacts","getContactPoint","getDistance","getAppliedImpulse","get_m_positionWorldOnB","get_m_normalWorldOnB","emptyV3","physicsBody","getNumManifolds","split","obj0","TYPE","FIT","hasUpdateMatricesFunction","createCollisionShapes","createBoxShape","createCylinderShape","createCapsuleShape","createConeShape","createSphereShape","createHullShape","createHACDShapes","createVHACDShapes","createTriMeshShape","createHeightfieldTerrainShape","_setOptions","fit","halfExtents","_computeHalfExtents","_computeBounds","minHalfExtent","maxHalfExtent","btHalfExtents","collisionShape","btBoxShape","_finishCollisionShape","_computeScale","cylinderAxis","btCylinderShape","btCylinderShapeX","btCylinderShapeZ","btCapsuleShape","btCapsuleShapeX","btCapsuleShapeZ","btConeShape","btConeShapeX","btConeShapeZ","sphereRadius","_computeRadius","btSphereShape","vertex","bounds","btVertex","originalHull","btConvexHullShape","setMargin","margin","min","multiplyScalar","vertexCount","_iterateGeometries","geo","maxVertices","hullMaxVertices","adjustGeometryTranslateEXPERIMENTAL","components","applyMatrix4","addPoint","getNumVertices","shapeHull","btShapeHull","buildHull","getPointer","getVertexPointer","numVertices","scale","triCount","hacd","HACD","SetCompacityWeight","compacityWeight","SetVolumeWeight","volumeWeight","SetNClusters","nClusters","SetNVerticesPerCH","nVerticesPerCH","SetConcavity","concavity","_malloc","triangles","SetPoints","SetTriangles","SetNPoints","SetNTriangles","pptr","tptr","HEAPF64","HEAP32","Compute","_free","GetNClusters","shapes","hull","nPoints","GetNPointsCH","nTriangles","GetNTrianglesCH","hullPoints","hullTriangles","GetCH","pi","px","py","pz","vhacd","VHACD","params","Parameters","set_m_resolution","resolution","set_m_depth","set_m_concavity","set_m_planeDownsampling","planeDownsampling","set_m_convexhullDownsampling","convexhullDownsampling","set_m_alpha","alpha","set_m_beta","beta","set_m_gamma","gamma","set_m_pca","pca","set_m_mode","set_m_maxNumVerticesPerCH","maxNumVerticesPerCH","set_m_minVolumePerCH","minVolumePerCH","set_m_convexhullApproximation","convexhullApproximation","set_m_oclAcceleration","oclAcceleration","nHulls","GetNConvexHulls","ch","ConvexHull","GetConvexHull","get_m_nPoints","get_m_points","bta","btb","btc","triMesh","btTriangleMesh","ai","bi","ci","addTriangle","concave","btBvhTriangleMeshShape","btConvexTriangleMeshShape","resources","heightfieldDistance","heightfieldData","heightScale","upAxis","hdt","heightDataType","PHY_SHORT","PHY_FLOAT","flipQuadEdges","heightStickLength","heightStickWidth","minHeight","POSITIVE_INFINITY","maxHeight","NEGATIVE_INFINITY","btHeightfieldTerrainShape","setLocalScaling","includeInvisible","orientation","res","localScale","getInverse","matrixWorld","traverse","isMesh","identity","updateMatrices","multiplyMatrices","fromGeometry","maxRadiusSq","cx","cy","cz","getCenter","subVectors","clampScalar","minX","Infinity","minY","minZ","maxX","maxY","maxZ","computeBoundingBox","boundingBox","makeTranslation","oldTime","elapsedTime","running","performance","diff","newTime","log","collider","constraints","addConstraints","addCompoundShape","compoundShape","btCompoundShape","tmp","addChildShape","quat","addRigidBody","addChildren","defaultParams","children","child","test","parameters","Shape","addShape","addRigidBodyToShape","addBodyProperties","opts","SIMD_PI","subdivisions","gap","cos","cylinderShape","forward","rotation","rotate","addTorusShape","createRigidBody","physicsShape","motionState","btDefaultMotionState","localInertia","calculateLocalInertia","rbInfo","btRigidBodyConstructionInfo","threeObject","rigidBody","setActivationState","friction"],"mappings":"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","file":"enable3d.ammoPhysics.0.0.16.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"THREE\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"THREE\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"ENABLE3D\"] = factory(require(\"THREE\"));\n\telse\n\t\troot[\"ENABLE3D\"] = factory(root[\"THREE\"]);\n})(window, function(__WEBPACK_EXTERNAL_MODULE__0__) {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 17);\n","module.exports = __WEBPACK_EXTERNAL_MODULE__0__;","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar logger = function (msg) {\n    console.error(\"%c [enable3d] \" + msg + \" \", 'background: #222; color: #bada55');\n};\nexports.default = logger;\n//# sourceMappingURL=logger.js.map","'use strict';\n\nvar has = Object.prototype.hasOwnProperty\n  , prefix = '~';\n\n/**\n * Constructor to create a storage for our `EE` objects.\n * An `Events` instance is a plain object whose properties are event names.\n *\n * @constructor\n * @private\n */\nfunction Events() {}\n\n//\n// We try to not inherit from `Object.prototype`. In some engines creating an\n// instance in this way is faster than calling `Object.create(null)` directly.\n// If `Object.create(null)` is not supported we prefix the event names with a\n// character to make sure that the built-in object properties are not\n// overridden or used as an attack vector.\n//\nif (Object.create) {\n  Events.prototype = Object.create(null);\n\n  //\n  // This hack is needed because the `__proto__` property is still inherited in\n  // some old browsers like Android 4, iPhone 5.1, Opera 11 and Safari 5.\n  //\n  if (!new Events().__proto__) prefix = false;\n}\n\n/**\n * Representation of a single event listener.\n *\n * @param {Function} fn The listener function.\n * @param {*} context The context to invoke the listener with.\n * @param {Boolean} [once=false] Specify if the listener is a one-time listener.\n * @constructor\n * @private\n */\nfunction EE(fn, context, once) {\n  this.fn = fn;\n  this.context = context;\n  this.once = once || false;\n}\n\n/**\n * Add a listener for a given event.\n *\n * @param {EventEmitter} emitter Reference to the `EventEmitter` instance.\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} context The context to invoke the listener with.\n * @param {Boolean} once Specify if the listener is a one-time listener.\n * @returns {EventEmitter}\n * @private\n */\nfunction addListener(emitter, event, fn, context, once) {\n  if (typeof fn !== 'function') {\n    throw new TypeError('The listener must be a function');\n  }\n\n  var listener = new EE(fn, context || emitter, once)\n    , evt = prefix ? prefix + event : event;\n\n  if (!emitter._events[evt]) emitter._events[evt] = listener, emitter._eventsCount++;\n  else if (!emitter._events[evt].fn) emitter._events[evt].push(listener);\n  else emitter._events[evt] = [emitter._events[evt], listener];\n\n  return emitter;\n}\n\n/**\n * Clear event by name.\n *\n * @param {EventEmitter} emitter Reference to the `EventEmitter` instance.\n * @param {(String|Symbol)} evt The Event name.\n * @private\n */\nfunction clearEvent(emitter, evt) {\n  if (--emitter._eventsCount === 0) emitter._events = new Events();\n  else delete emitter._events[evt];\n}\n\n/**\n * Minimal `EventEmitter` interface that is molded against the Node.js\n * `EventEmitter` interface.\n *\n * @constructor\n * @public\n */\nfunction EventEmitter() {\n  this._events = new Events();\n  this._eventsCount = 0;\n}\n\n/**\n * Return an array listing the events for which the emitter has registered\n * listeners.\n *\n * @returns {Array}\n * @public\n */\nEventEmitter.prototype.eventNames = function eventNames() {\n  var names = []\n    , events\n    , name;\n\n  if (this._eventsCount === 0) return names;\n\n  for (name in (events = this._events)) {\n    if (has.call(events, name)) names.push(prefix ? name.slice(1) : name);\n  }\n\n  if (Object.getOwnPropertySymbols) {\n    return names.concat(Object.getOwnPropertySymbols(events));\n  }\n\n  return names;\n};\n\n/**\n * Return the listeners registered for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Array} The registered listeners.\n * @public\n */\nEventEmitter.prototype.listeners = function listeners(event) {\n  var evt = prefix ? prefix + event : event\n    , handlers = this._events[evt];\n\n  if (!handlers) return [];\n  if (handlers.fn) return [handlers.fn];\n\n  for (var i = 0, l = handlers.length, ee = new Array(l); i < l; i++) {\n    ee[i] = handlers[i].fn;\n  }\n\n  return ee;\n};\n\n/**\n * Return the number of listeners listening to a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Number} The number of listeners.\n * @public\n */\nEventEmitter.prototype.listenerCount = function listenerCount(event) {\n  var evt = prefix ? prefix + event : event\n    , listeners = this._events[evt];\n\n  if (!listeners) return 0;\n  if (listeners.fn) return 1;\n  return listeners.length;\n};\n\n/**\n * Calls each of the listeners registered for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Boolean} `true` if the event had listeners, else `false`.\n * @public\n */\nEventEmitter.prototype.emit = function emit(event, a1, a2, a3, a4, a5) {\n  var evt = prefix ? prefix + event : event;\n\n  if (!this._events[evt]) return false;\n\n  var listeners = this._events[evt]\n    , len = arguments.length\n    , args\n    , i;\n\n  if (listeners.fn) {\n    if (listeners.once) this.removeListener(event, listeners.fn, undefined, true);\n\n    switch (len) {\n      case 1: return listeners.fn.call(listeners.context), true;\n      case 2: return listeners.fn.call(listeners.context, a1), true;\n      case 3: return listeners.fn.call(listeners.context, a1, a2), true;\n      case 4: return listeners.fn.call(listeners.context, a1, a2, a3), true;\n      case 5: return listeners.fn.call(listeners.context, a1, a2, a3, a4), true;\n      case 6: return listeners.fn.call(listeners.context, a1, a2, a3, a4, a5), true;\n    }\n\n    for (i = 1, args = new Array(len -1); i < len; i++) {\n      args[i - 1] = arguments[i];\n    }\n\n    listeners.fn.apply(listeners.context, args);\n  } else {\n    var length = listeners.length\n      , j;\n\n    for (i = 0; i < length; i++) {\n      if (listeners[i].once) this.removeListener(event, listeners[i].fn, undefined, true);\n\n      switch (len) {\n        case 1: listeners[i].fn.call(listeners[i].context); break;\n        case 2: listeners[i].fn.call(listeners[i].context, a1); break;\n        case 3: listeners[i].fn.call(listeners[i].context, a1, a2); break;\n        case 4: listeners[i].fn.call(listeners[i].context, a1, a2, a3); break;\n        default:\n          if (!args) for (j = 1, args = new Array(len -1); j < len; j++) {\n            args[j - 1] = arguments[j];\n          }\n\n          listeners[i].fn.apply(listeners[i].context, args);\n      }\n    }\n  }\n\n  return true;\n};\n\n/**\n * Add a listener for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} [context=this] The context to invoke the listener with.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.on = function on(event, fn, context) {\n  return addListener(this, event, fn, context, false);\n};\n\n/**\n * Add a one-time listener for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} [context=this] The context to invoke the listener with.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.once = function once(event, fn, context) {\n  return addListener(this, event, fn, context, true);\n};\n\n/**\n * Remove the listeners of a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn Only remove the listeners that match this function.\n * @param {*} context Only remove the listeners that have this context.\n * @param {Boolean} once Only remove one-time listeners.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.removeListener = function removeListener(event, fn, context, once) {\n  var evt = prefix ? prefix + event : event;\n\n  if (!this._events[evt]) return this;\n  if (!fn) {\n    clearEvent(this, evt);\n    return this;\n  }\n\n  var listeners = this._events[evt];\n\n  if (listeners.fn) {\n    if (\n      listeners.fn === fn &&\n      (!once || listeners.once) &&\n      (!context || listeners.context === context)\n    ) {\n      clearEvent(this, evt);\n    }\n  } else {\n    for (var i = 0, events = [], length = listeners.length; i < length; i++) {\n      if (\n        listeners[i].fn !== fn ||\n        (once && !listeners[i].once) ||\n        (context && listeners[i].context !== context)\n      ) {\n        events.push(listeners[i]);\n      }\n    }\n\n    //\n    // Reset the array, or remove it completely if we have no more listeners.\n    //\n    if (events.length) this._events[evt] = events.length === 1 ? events[0] : events;\n    else clearEvent(this, evt);\n  }\n\n  return this;\n};\n\n/**\n * Remove all listeners, or those of the specified event.\n *\n * @param {(String|Symbol)} [event] The event name.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.removeAllListeners = function removeAllListeners(event) {\n  var evt;\n\n  if (event) {\n    evt = prefix ? prefix + event : event;\n    if (this._events[evt]) clearEvent(this, evt);\n  } else {\n    this._events = new Events();\n    this._eventsCount = 0;\n  }\n\n  return this;\n};\n\n//\n// Alias methods names because people roll like that.\n//\nEventEmitter.prototype.off = EventEmitter.prototype.removeListener;\nEventEmitter.prototype.addListener = EventEmitter.prototype.on;\n\n//\n// Expose the prefix.\n//\nEventEmitter.prefixed = prefix;\n\n//\n// Allow `EventEmitter` to be imported as module namespace.\n//\nEventEmitter.EventEmitter = EventEmitter;\n\n//\n// Expose the module.\n//\nif ('undefined' !== typeof module) {\n  module.exports = EventEmitter;\n}\n","\"use strict\";\n/**\n * @author       Yannick Deubel (https://github.com/yandeu)\n * @copyright    Copyright (c) 2020 Yannick Deubel; Project Url: https://github.com/enable3d/enable3d\n * @license      {@link https://github.com/enable3d/enable3d/blob/master/LICENSE|GNU GPLv3}\n */\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar index_1 = require(\"@enable3d/three-wrapper/dist/index\");\nvar logger_1 = __importDefault(require(\"./logger\"));\n/**\n * Extends the Object3D class from THREE.js and implements properties from Line, Mesh and Points.\n */\nvar ExtendedObject3D = /** @class */ (function (_super) {\n    __extends(ExtendedObject3D, _super);\n    function ExtendedObject3D() {\n        var _this = _super.call(this) || this;\n        _this.vector3 = new index_1.Vector3();\n        _this.hasBody = false;\n        _this.anims = {};\n        _this.currentAnimation = '';\n        _this.name = \"object-\" + _this.id;\n        return _this;\n    }\n    Object.defineProperty(ExtendedObject3D.prototype, \"world\", {\n        /** Returns all values relative to the world. */\n        get: function () {\n            return {\n                theta: this.worldTheta,\n                phi: this.worldPhi\n            };\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ExtendedObject3D.prototype, \"worldTheta\", {\n        /** Get the theta relative to the world. */\n        get: function () {\n            this.getWorldDirection(this.vector3);\n            return Math.atan2(this.vector3.x, this.vector3.z);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ExtendedObject3D.prototype, \"worldPhi\", {\n        /** Get the phi relative to the world. */\n        get: function () {\n            this.getWorldDirection(this.vector3);\n            return Math.acos(this.vector3.y);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    ExtendedObject3D.prototype.setAction = function (name) {\n        var _a;\n        if (this.mixer && this.anims.hasOwnProperty(name)) {\n            var action = (_a = this.mixer) === null || _a === void 0 ? void 0 : _a.clipAction(this.anims[name]);\n            action.time = 0;\n            this.mixer.stopAllAction();\n            action.fadeIn(0.5);\n            action.play();\n            this.currentAnimation = name;\n        }\n        else {\n            logger_1.default(\"[Phaser3D] Can't set animation \" + name);\n        }\n    };\n    return ExtendedObject3D;\n}(index_1.Object3D));\nexports.default = ExtendedObject3D;\n//# sourceMappingURL=extendedObject3D.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar index_1 = require(\"@enable3d/three-wrapper/dist/index\");\nvar DefaultMaterial = /** @class */ (function () {\n    function DefaultMaterial() {\n        this._defaultMaterial = new index_1.MeshLambertMaterial({ color: 0xcccccc });\n    }\n    DefaultMaterial.prototype.get = function () {\n        return this._defaultMaterial;\n    };\n    return DefaultMaterial;\n}());\nexports.default = DefaultMaterial;\n//# sourceMappingURL=defaultMaterial.js.map","\"use strict\";\n/**\n * @author       Yannick Deubel (https://github.com/yandeu)\n * @copyright    Copyright (c) 2020 Yannick Deubel; Project Url: https://github.com/enable3d/enable3d\n * @license      {@link https://github.com/enable3d/enable3d/blob/master/LICENSE|GNU GPLv3}\n */\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar index_1 = require(\"@enable3d/three-wrapper/dist/index\");\nvar logger_1 = __importDefault(require(\"./logger\"));\nvar ExtendedMesh = /** @class */ (function (_super) {\n    __extends(ExtendedMesh, _super);\n    function ExtendedMesh(geometry, material) {\n        var _this = _super.call(this, geometry, material) || this;\n        _this.vector3 = new index_1.Vector3();\n        _this.hasBody = false;\n        _this.anims = {};\n        _this.currentAnimation = '';\n        _this.name = \"object-\" + _this.id;\n        return _this;\n    }\n    Object.defineProperty(ExtendedMesh.prototype, \"world\", {\n        /** Returns all values relative to the world. */\n        get: function () {\n            return {\n                theta: this.worldTheta,\n                phi: this.worldPhi\n            };\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ExtendedMesh.prototype, \"worldTheta\", {\n        /** Get the theta relative to the world. */\n        get: function () {\n            this.getWorldDirection(this.vector3);\n            return Math.atan2(this.vector3.x, this.vector3.z);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ExtendedMesh.prototype, \"worldPhi\", {\n        /** Get the phi relative to the world. */\n        get: function () {\n            this.getWorldDirection(this.vector3);\n            return Math.acos(this.vector3.y);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    ExtendedMesh.prototype.setAction = function (name) {\n        var _a;\n        if (this.mixer && this.anims.hasOwnProperty(name)) {\n            var action = (_a = this.mixer) === null || _a === void 0 ? void 0 : _a.clipAction(this.anims[name]);\n            action.time = 0;\n            this.mixer.stopAllAction();\n            action.fadeIn(0.5);\n            action.play();\n            this.currentAnimation = name;\n        }\n        else {\n            logger_1.default(\"[Phaser3D] Can't set animation \" + name);\n        }\n    };\n    return ExtendedMesh;\n}(index_1.Mesh));\nexports.default = ExtendedMesh;\n//# sourceMappingURL=extendedMesh.js.map","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar wasmLoader_1 = __importDefault(require(\"./wasmLoader\"));\nvar PhysicsLoader = function (path, callback) {\n    window.__loadPhysics = true;\n    wasmLoader_1.default(path, function () {\n        Ammo().then(function () {\n            callback();\n        });\n    });\n};\nexports.PhysicsLoader = PhysicsLoader;\n//# sourceMappingURL=physicsLoader.js.map","\"use strict\";\n/**\n * @author       Yannick Deubel (https://github.com/yandeu)\n * @copyright    Copyright (c) 2020 Yannick Deubel; Project Url: https://github.com/enable3d/enable3d\n * @license      {@link https://github.com/enable3d/enable3d/blob/master/LICENSE|GNU GPLv3}\n */\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar extendedObject3D_1 = __importDefault(require(\"./extendedObject3D\"));\nexports.ExtendedObject3D = extendedObject3D_1.default;\nvar extendedMesh_1 = __importDefault(require(\"./extendedMesh\"));\nexports.ExtendedMesh = extendedMesh_1.default;\n// TODO fix this export\n// export { ThirdPersonControls } from '../misc/thirdPersonControls'\nvar index_1 = require(\"@enable3d/three-wrapper/dist/index\");\nexports.AnimationMixer = index_1.AnimationMixer;\nexports.AnimationClip = index_1.AnimationClip;\nexports.AnimationAction = index_1.AnimationAction;\nexports.Object3D = index_1.Object3D;\nexports.Mesh = index_1.Mesh;\nexports.Material = index_1.Material;\nexports.Line = index_1.Line;\nexports.Points = index_1.Points;\nexports.Group = index_1.Group;\n//# sourceMappingURL=types.js.map","\"use strict\";\n/**\n * @author       Yannick Deubel (https://github.com/yandeu)\n * @copyright    Copyright (c) 2020 Yannick Deubel; Project Url: https://github.com/enable3d/enable3d\n * @license      {@link https://github.com/enable3d/enable3d/blob/master/LICENSE|GNU GPLv3}\n */\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\n/**\n * @author       Alex Bennett (https://github.com/timetocode)\n * @copyright    Copyright (c) 2014 Alex Bennett; Project Url: https://github.com/timetocode/node-game-loop\n * @license      {@link https://github.com/timetocode/node-game-loop/blob/master/LICENSE|MIT}\n */\nvar EventEmitter = require('events');\n/**\n * A more precise clock than setTimeout(cb, ms).\n * But costs slightly more cpu.\n */\nvar ServerClock = /** @class */ (function (_super) {\n    __extends(ServerClock, _super);\n    function ServerClock(ms, autoStart) {\n        if (ms === void 0) { ms = 60; }\n        if (autoStart === void 0) { autoStart = true; }\n        var _this = _super.call(this) || this;\n        /**\n         * Length of a tick in milliseconds. The denominator is your desired framerate.\n         * e.g. 1000 / 20 = 20 fps,  1000 / 60 = 60 fps\n         */\n        _this.tickLengthMs = 1000 / 60;\n        /** timestamp of each loop */\n        _this.previousTick = Date.now();\n        /** number of times ServerClock gets called */\n        _this.actualTicks = 0;\n        /** store the delta value */\n        _this._delta = 0;\n        /** store is the clock is running or not */\n        _this._isRunning = false;\n        if (autoStart)\n            _this.start(ms);\n        return _this;\n    }\n    /**\n     * Start the clock.\n     * @param ms Interval in milliseconds. Default is 60 fps.\n     */\n    ServerClock.prototype.start = function (ms) {\n        if (ms === void 0) { ms = 60; }\n        this.tickLengthMs = 1000 / ms;\n        this._isRunning = true;\n        this.startTime = Date.now();\n        this.loop();\n    };\n    /** Stop the clock */\n    ServerClock.prototype.stop = function () {\n        this._isRunning = false;\n    };\n    /** Is clock running? */\n    ServerClock.prototype.isRunning = function () {\n        return this._isRunning;\n    };\n    /** Returns the last delta value. */\n    ServerClock.prototype.getDelta = function () {\n        return this._delta;\n    };\n    /** Keeps track of the total time that the clock has been running. */\n    ServerClock.prototype.getElapsedTime = function () {\n        return Date.now() - this.startTime;\n    };\n    /** Event listener for every new tick. */\n    ServerClock.prototype.onTick = function (cb) {\n        var _this = this;\n        return this.on('tick', function () { return cb(_this._delta); });\n    };\n    ServerClock.prototype.loop = function () {\n        var _this = this;\n        if (!this._isRunning)\n            return;\n        var now = Date.now();\n        this.actualTicks++;\n        if (this.previousTick + this.tickLengthMs <= now) {\n            this._delta = (now - this.previousTick) / 1000;\n            this.previousTick = now;\n            this.emit('tick', this._delta);\n            // console.log(\n            //   'this._delta',\n            //   this._delta,\n            //   '(target: ' + this.tickLengthMs + ' ms)',\n            //   'node ticks',\n            //   this.actualTicks\n            // )\n            this.actualTicks = 0;\n        }\n        if (Date.now() - this.previousTick < this.tickLengthMs - 16) {\n            setTimeout(function () { return _this.loop(); });\n        }\n        else {\n            setImmediate(function () { return _this.loop(); });\n        }\n    };\n    return ServerClock;\n}(EventEmitter));\nexports.ServerClock = ServerClock;\n//# sourceMappingURL=serverClock.js.map","var g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || new Function(\"return this\")();\n} catch (e) {\n\t// This works if the window reference is available\n\tif (typeof window === \"object\") g = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n// https://www.typescriptlang.org/docs/handbook/mixins.html\nvar applyMixins = function (derivedCtor, baseCtors) {\n    baseCtors.forEach(function (baseCtor) {\n        Object.getOwnPropertyNames(baseCtor.prototype).forEach(function (name) {\n            // @ts-ignore\n            Object.defineProperty(derivedCtor.prototype, name, Object.getOwnPropertyDescriptor(baseCtor.prototype, name));\n        });\n    });\n};\nexports.default = applyMixins;\n//# sourceMappingURL=applyMixins.js.map","\"use strict\";\n/**\n * @author       Yannick Deubel (https://github.com/yandeu)\n * @copyright    Copyright (c) 2020 Yannick Deubel; Project Url: https://github.com/enable3d/enable3d\n * @license      {@link https://github.com/enable3d/enable3d/blob/master/LICENSE|GNU GPLv3}\n */\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __rest = (this && this.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar index_1 = require(\"@enable3d/three-wrapper/dist/index\");\nvar extendedMesh_1 = __importDefault(require(\"./extendedMesh\"));\nvar logger_1 = __importDefault(require(\"./logger\"));\nvar defaultMaterial_1 = __importDefault(require(\"./defaultMaterial\"));\nvar Factories = /** @class */ (function () {\n    function Factories(scene) {\n        this.scene = scene;\n        this.isHeadless = scene === 'headless' ? true : false;\n        this.defaultMaterial = new defaultMaterial_1.default();\n    }\n    Object.defineProperty(Factories.prototype, \"make\", {\n        get: function () {\n            var _this = this;\n            return {\n                plane: function (planeConfig, materialConfig) {\n                    if (planeConfig === void 0) { planeConfig = {}; }\n                    if (materialConfig === void 0) { materialConfig = {}; }\n                    return _this.makePlane(planeConfig, materialConfig);\n                },\n                box: function (boxConfig, materialConfig) {\n                    if (boxConfig === void 0) { boxConfig = {}; }\n                    if (materialConfig === void 0) { materialConfig = {}; }\n                    return _this.makeBox(boxConfig, materialConfig);\n                },\n                sphere: function (sphereConfig, materialConfig) {\n                    if (sphereConfig === void 0) { sphereConfig = {}; }\n                    if (materialConfig === void 0) { materialConfig = {}; }\n                    return _this.makeSphere(sphereConfig, materialConfig);\n                },\n                cylinder: function (cylinderConfig, materialConfig) {\n                    if (cylinderConfig === void 0) { cylinderConfig = {}; }\n                    if (materialConfig === void 0) { materialConfig = {}; }\n                    return _this.makeCylinder(cylinderConfig, materialConfig);\n                },\n                cone: function (coneConfig, materialConfig) {\n                    if (coneConfig === void 0) { coneConfig = {}; }\n                    if (materialConfig === void 0) { materialConfig = {}; }\n                    return _this.makeCone(coneConfig, materialConfig);\n                },\n                torus: function (torusConfig, materialConfig) {\n                    if (torusConfig === void 0) { torusConfig = {}; }\n                    if (materialConfig === void 0) { materialConfig = {}; }\n                    return _this.makeTorus(torusConfig, materialConfig);\n                },\n                extrude: function (extrudeConfig, materialConfig) {\n                    if (materialConfig === void 0) { materialConfig = {}; }\n                    return _this.makeExtrude(extrudeConfig, materialConfig);\n                }\n            };\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Factories.prototype, \"add\", {\n        get: function () {\n            var _this = this;\n            return {\n                // effectComposer: () => this.addEffectComposer(),\n                mesh: function (mesh) { return _this.addMesh(mesh); },\n                // group: (...children) => this.addGroup(children),\n                existing: function (object) { return _this.addExisting(object); },\n                //  Geometry\n                plane: function (planeConfig, materialConfig) {\n                    if (planeConfig === void 0) { planeConfig = {}; }\n                    if (materialConfig === void 0) { materialConfig = {}; }\n                    return _this.addPlane(planeConfig, materialConfig);\n                },\n                box: function (boxConfig, materialConfig) {\n                    if (boxConfig === void 0) { boxConfig = {}; }\n                    if (materialConfig === void 0) { materialConfig = {}; }\n                    return _this.addBox(boxConfig, materialConfig);\n                },\n                ground: function (groundConfig, materialConfig) {\n                    if (materialConfig === void 0) { materialConfig = {}; }\n                    return _this.addGround(groundConfig, materialConfig);\n                },\n                //...\n                sphere: function (sphereConfig, materialConfig) {\n                    if (sphereConfig === void 0) { sphereConfig = {}; }\n                    if (materialConfig === void 0) { materialConfig = {}; }\n                    return _this.addSphere(sphereConfig, materialConfig);\n                },\n                cylinder: function (cylinderConfig, materialConfig) {\n                    if (cylinderConfig === void 0) { cylinderConfig = {}; }\n                    if (materialConfig === void 0) { materialConfig = {}; }\n                    return _this.addCylinder(cylinderConfig, materialConfig);\n                },\n                cone: function (coneConfig, materialConfig) {\n                    if (coneConfig === void 0) { coneConfig = {}; }\n                    if (materialConfig === void 0) { materialConfig = {}; }\n                    return _this.addCone(coneConfig, materialConfig);\n                },\n                torus: function (torusConfig, materialConfig) {\n                    if (torusConfig === void 0) { torusConfig = {}; }\n                    if (materialConfig === void 0) { materialConfig = {}; }\n                    return _this.addTorus(torusConfig, materialConfig);\n                },\n                extrude: function (extrudeConfig, materialConfig) {\n                    if (materialConfig === void 0) { materialConfig = {}; }\n                    return _this.addExtrude(extrudeConfig, materialConfig);\n                },\n                //...\n                material: function (materialConfig) {\n                    if (materialConfig === void 0) { materialConfig = {}; }\n                    return _this.addMaterial(materialConfig);\n                }\n            };\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Factories.prototype.addExisting = function () {\n        var _a;\n        var object = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            object[_i] = arguments[_i];\n        }\n        if (this.scene === 'headless')\n            return;\n        (_a = this.scene).add.apply(_a, object);\n    };\n    Factories.prototype.addMesh = function (mesh) {\n        if (Array.isArray(mesh)) {\n            for (var i = 0; i < mesh.length; i++) {\n                this.addExisting(mesh[i]);\n            }\n        }\n        else {\n            this.addExisting(mesh);\n        }\n        return this;\n    };\n    Factories.prototype.createMesh = function (geometry, material, position) {\n        var _a = position.x, x = _a === void 0 ? 0 : _a, _b = position.y, y = _b === void 0 ? 0 : _b, _c = position.z, z = _c === void 0 ? 0 : _c;\n        var obj;\n        switch (!Array.isArray(material) && material.type) {\n            case 'LineBasicMaterial':\n                obj = new index_1.Line(geometry, material);\n                break;\n            case 'PointsMaterial':\n                obj = new index_1.Points(geometry, material);\n                break;\n            default:\n                obj = new extendedMesh_1.default(geometry, material);\n                break;\n        }\n        obj.position.set(x, y, z);\n        obj.castShadow = obj.receiveShadow = true;\n        return obj;\n    };\n    Factories.prototype.makeExtrude = function (extrudeConfig, materialConfig) {\n        var x = extrudeConfig.x, y = extrudeConfig.y, z = extrudeConfig.z, name = extrudeConfig.name, shape = extrudeConfig.shape, _a = extrudeConfig.autoCenter, autoCenter = _a === void 0 ? true : _a, _b = extrudeConfig.breakable, breakable = _b === void 0 ? false : _b, _c = extrudeConfig.bufferGeometry, bufferGeometry = _c === void 0 ? true : _c, rest = __rest(extrudeConfig, [\"x\", \"y\", \"z\", \"name\", \"shape\", \"autoCenter\", \"breakable\", \"bufferGeometry\"]);\n        var _d = rest.depth, depth = _d === void 0 ? 1 : _d, _e = rest.bevelEnabled, bevelEnabled = _e === void 0 ? false : _e;\n        var geometry = bufferGeometry || breakable || this.isHeadless\n            ? new index_1.ExtrudeBufferGeometry(shape, __assign({ depth: depth, bevelEnabled: bevelEnabled }, rest))\n            : new index_1.ExtrudeGeometry(shape, __assign({ depth: depth, bevelEnabled: bevelEnabled }, rest));\n        var material = this.addMaterial(materialConfig);\n        var mesh = this.createMesh(geometry, material, { x: x, y: y, z: z });\n        // auto adjust the center for custom shapes\n        if (autoCenter)\n            mesh.geometry.center();\n        mesh.name = name || \"body_id_\" + mesh.id;\n        mesh.shape = 'extrude';\n        return mesh;\n    };\n    Factories.prototype.addExtrude = function (extrudeConfig, materialConfig) {\n        if (materialConfig === void 0) { materialConfig = {}; }\n        var obj = this.makeExtrude(extrudeConfig, materialConfig);\n        this.addExisting(obj);\n        return obj;\n    };\n    Factories.prototype.makePlane = function (planeConfig, materialConfig) {\n        var x = planeConfig.x, y = planeConfig.y, z = planeConfig.z, name = planeConfig.name, _a = planeConfig.breakable, breakable = _a === void 0 ? false : _a, _b = planeConfig.bufferGeometry, bufferGeometry = _b === void 0 ? true : _b, rest = __rest(planeConfig, [\"x\", \"y\", \"z\", \"name\", \"breakable\", \"bufferGeometry\"]);\n        var geometry = bufferGeometry || breakable || this.isHeadless\n            ? new index_1.PlaneBufferGeometry(rest.width || 1, rest.height || 1, rest.widthSegments || 1, rest.heightSegments || 1)\n            : new index_1.PlaneGeometry(rest.width || 1, rest.height || 1, rest.widthSegments || 1, rest.heightSegments || 1);\n        var material = this.addMaterial(materialConfig);\n        material.side = index_1.DoubleSide;\n        var mesh = this.createMesh(geometry, material, { x: x, y: y, z: z });\n        mesh.name = name || \"body_id_\" + mesh.id;\n        mesh.shape = 'plane';\n        return mesh;\n    };\n    Factories.prototype.addPlane = function (planeConfig, materialConfig) {\n        var obj = this.makePlane(planeConfig, materialConfig);\n        this.addExisting(obj);\n        return obj;\n    };\n    Factories.prototype.makeSphere = function (sphereConfig, materialConfig) {\n        var x = sphereConfig.x, y = sphereConfig.y, z = sphereConfig.z, name = sphereConfig.name, _a = sphereConfig.breakable, breakable = _a === void 0 ? false : _a, _b = sphereConfig.bufferGeometry, bufferGeometry = _b === void 0 ? true : _b, rest = __rest(sphereConfig, [\"x\", \"y\", \"z\", \"name\", \"breakable\", \"bufferGeometry\"]);\n        var geometry = bufferGeometry || breakable || this.isHeadless\n            ? new index_1.SphereBufferGeometry(rest.radius || 1, rest.widthSegments || 16, rest.heightSegments || 12, rest.phiStart || undefined, rest.phiLength || undefined, rest.thetaStart || undefined, rest.thetaLength || undefined)\n            : new index_1.SphereGeometry(rest.radius || 1, rest.widthSegments || 16, rest.heightSegments || 12, rest.phiStart || undefined, rest.phiLength || undefined, rest.thetaStart || undefined, rest.thetaLength || undefined);\n        var material = this.addMaterial(materialConfig);\n        var mesh = this.createMesh(geometry, material, { x: x, y: y, z: z });\n        mesh.name = name || \"body_id_\" + mesh.id;\n        mesh.shape = 'sphere';\n        return mesh;\n    };\n    Factories.prototype.addSphere = function (sphereConfig, materialConfig) {\n        if (sphereConfig === void 0) { sphereConfig = {}; }\n        if (materialConfig === void 0) { materialConfig = {}; }\n        var obj = this.makeSphere(sphereConfig, materialConfig);\n        this.addExisting(obj);\n        return obj;\n    };\n    Factories.prototype.makeBox = function (boxConfig, materialConfig) {\n        var x = boxConfig.x, y = boxConfig.y, z = boxConfig.z, name = boxConfig.name, _a = boxConfig.breakable, breakable = _a === void 0 ? false : _a, _b = boxConfig.bufferGeometry, bufferGeometry = _b === void 0 ? true : _b, rest = __rest(boxConfig, [\"x\", \"y\", \"z\", \"name\", \"breakable\", \"bufferGeometry\"]);\n        var geometry = bufferGeometry || breakable || this.isHeadless\n            ? new index_1.BoxBufferGeometry(rest.width || 1, rest.height || 1, rest.depth || 1, rest.widthSegments || undefined, rest.heightSegments || undefined, rest.depthSegments || undefined)\n            : new index_1.BoxGeometry(rest.width || 1, rest.height || 1, rest.depth || 1, rest.widthSegments || undefined, rest.heightSegments || undefined, rest.depthSegments || undefined);\n        var material = this.addMaterial(materialConfig);\n        var mesh = this.createMesh(geometry, material, { x: x, y: y, z: z });\n        mesh.name = name || \"body_id_\" + mesh.id;\n        mesh.shape = 'box';\n        return mesh;\n    };\n    Factories.prototype.addBox = function (boxConfig, materialConfig) {\n        if (boxConfig === void 0) { boxConfig = {}; }\n        if (materialConfig === void 0) { materialConfig = {}; }\n        var obj = this.makeBox(boxConfig, materialConfig);\n        this.addExisting(obj);\n        return obj;\n    };\n    Factories.prototype.addGround = function (groundConfig, materialConfig) {\n        if (materialConfig === void 0) { materialConfig = {}; }\n        var obj = this.makeBox(groundConfig, materialConfig);\n        obj.rotateX(index_1.MathUtils.degToRad(90));\n        this.addExisting(obj);\n        return obj;\n    };\n    Factories.prototype.makeCylinder = function (cylinderConfig, materialConfig) {\n        if (cylinderConfig === void 0) { cylinderConfig = {}; }\n        if (materialConfig === void 0) { materialConfig = {}; }\n        var x = cylinderConfig.x, y = cylinderConfig.y, z = cylinderConfig.z, name = cylinderConfig.name, _a = cylinderConfig.breakable, breakable = _a === void 0 ? false : _a, _b = cylinderConfig.bufferGeometry, bufferGeometry = _b === void 0 ? true : _b, rest = __rest(cylinderConfig, [\"x\", \"y\", \"z\", \"name\", \"breakable\", \"bufferGeometry\"]);\n        var geometry = bufferGeometry || breakable || this.isHeadless\n            ? new index_1.CylinderBufferGeometry(rest.radiusTop || 1, rest.radiusBottom || 1, rest.height || 1, rest.radiusSegments || undefined, rest.heightSegments || undefined, rest.openEnded || undefined, rest.thetaStart || undefined, rest.thetaLength || undefined)\n            : new index_1.CylinderGeometry(rest.radiusTop || 1, rest.radiusBottom || 1, rest.height || 1, rest.radiusSegments || undefined, rest.heightSegments || undefined, rest.openEnded || undefined, rest.thetaStart || undefined, rest.thetaLength || undefined);\n        var material = this.addMaterial(materialConfig);\n        var mesh = this.createMesh(geometry, material, { x: x, y: y, z: z });\n        mesh.name = name || \"body_id_\" + mesh.id;\n        mesh.shape = 'cylinder';\n        return mesh;\n    };\n    Factories.prototype.addCylinder = function (cylinderConfig, materialConfig) {\n        if (cylinderConfig === void 0) { cylinderConfig = {}; }\n        if (materialConfig === void 0) { materialConfig = {}; }\n        var obj = this.makeCylinder(cylinderConfig, materialConfig);\n        this.addExisting(obj);\n        return obj;\n    };\n    Factories.prototype.makeCone = function (coneConfig, materialConfig) {\n        if (coneConfig === void 0) { coneConfig = {}; }\n        if (materialConfig === void 0) { materialConfig = {}; }\n        var x = coneConfig.x, y = coneConfig.y, z = coneConfig.z, name = coneConfig.name, _a = coneConfig.breakable, breakable = _a === void 0 ? false : _a, _b = coneConfig.bufferGeometry, bufferGeometry = _b === void 0 ? true : _b, rest = __rest(coneConfig, [\"x\", \"y\", \"z\", \"name\", \"breakable\", \"bufferGeometry\"]);\n        var geometry = bufferGeometry || breakable || this.isHeadless\n            ? new index_1.ConeBufferGeometry(rest.radius || 1, rest.height || 1, rest.radiusSegments || 8, rest.heightSegments || 1, rest.openEnded || false, rest.thetaStart || 0, rest.thetaLength || 2 * Math.PI)\n            : new index_1.ConeBufferGeometry(rest.radius || 1, rest.height || 1, rest.radiusSegments || 8, rest.heightSegments || 1, rest.openEnded || false, rest.thetaStart || 0, rest.thetaLength || 2 * Math.PI);\n        var material = this.addMaterial(materialConfig);\n        var mesh = this.createMesh(geometry, material, { x: x, y: y, z: z });\n        mesh.name = name || \"body_id_\" + mesh.id;\n        mesh.shape = 'cone';\n        return mesh;\n    };\n    Factories.prototype.addCone = function (coneConfig, materialConfig) {\n        if (coneConfig === void 0) { coneConfig = {}; }\n        if (materialConfig === void 0) { materialConfig = {}; }\n        var obj = this.makeCone(coneConfig, materialConfig);\n        this.addExisting(obj);\n        return obj;\n    };\n    // https://threejs.org/docs/index.html#api/en/geometries/TorusBufferGeometry\n    Factories.prototype.makeTorus = function (torusConfig, materialConfig) {\n        if (torusConfig === void 0) { torusConfig = {}; }\n        if (materialConfig === void 0) { materialConfig = {}; }\n        var x = torusConfig.x, y = torusConfig.y, z = torusConfig.z, name = torusConfig.name, _a = torusConfig.breakable, breakable = _a === void 0 ? false : _a, _b = torusConfig.bufferGeometry, bufferGeometry = _b === void 0 ? true : _b, rest = __rest(torusConfig, [\"x\", \"y\", \"z\", \"name\", \"breakable\", \"bufferGeometry\"]);\n        var geometry = bufferGeometry || breakable || this.isHeadless\n            ? new index_1.TorusBufferGeometry(rest.radius || undefined, rest.tube || undefined, rest.radialSegments || undefined, rest.tubularSegments || undefined, rest.arc || undefined)\n            : new index_1.TorusGeometry(rest.radius || undefined, rest.tube || undefined, rest.radialSegments || undefined, rest.tubularSegments || undefined, rest.arc || undefined);\n        var material = this.addMaterial(materialConfig);\n        var mesh = this.createMesh(geometry, material, { x: x, y: y, z: z });\n        mesh.name = name || \"body_id_\" + mesh.id;\n        mesh.shape = 'torus';\n        return mesh;\n    };\n    Factories.prototype.addTorus = function (torusConfig, materialConfig) {\n        if (torusConfig === void 0) { torusConfig = {}; }\n        if (materialConfig === void 0) { materialConfig = {}; }\n        var obj = this.makeTorus(torusConfig, materialConfig);\n        this.addExisting(obj);\n        return obj;\n    };\n    Factories.prototype.addMaterial = function (materialConfig) {\n        if (materialConfig === void 0) { materialConfig = {}; }\n        var type = Object.keys(materialConfig)[0];\n        var material;\n        // if (type) {\n        //   const { map } = materialConfig[type]\n        //   if (typeof map === 'string') materialConfig[type].map = this.loadTexture(map)\n        // }\n        // always share the same material in headless mode to save memory\n        if (this.scene === 'headless')\n            return this.defaultMaterial.get();\n        switch (type) {\n            case 'basic':\n                material = new index_1.MeshBasicMaterial(materialConfig.basic);\n                break;\n            case 'normal':\n                material = new index_1.MeshNormalMaterial(materialConfig.normal);\n                break;\n            case 'standard':\n                material = new index_1.MeshStandardMaterial(materialConfig.standard);\n                break;\n            case 'lambert':\n                material = new index_1.MeshLambertMaterial(materialConfig.lambert);\n                break;\n            case 'phong':\n                material = new index_1.MeshPhongMaterial(materialConfig.phong);\n                break;\n            case 'physical':\n                if (typeof materialConfig.physical !== 'undefined') {\n                    material = new index_1.MeshPhysicalMaterial(materialConfig.physical);\n                }\n                else {\n                    logger_1.default('You need to pass parameters to the physical material. (Fallback to default material)');\n                    material = this.defaultMaterial.get();\n                }\n                break;\n            case 'toon':\n                material = new index_1.MeshToonMaterial(materialConfig.toon);\n                break;\n            case 'line':\n                material = new index_1.LineBasicMaterial(materialConfig.line);\n                break;\n            case 'points':\n                material = new index_1.PointsMaterial(materialConfig.points);\n                break;\n            case 'custom':\n                material = materialConfig.custom || this.defaultMaterial.get();\n                break;\n            default:\n                material = this.defaultMaterial.get();\n                break;\n        }\n        return material;\n    };\n    return Factories;\n}());\nexports.default = Factories;\n//# sourceMappingURL=factories.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n// Inspired by https://github.com/playcanvas/engine/blob/master/examples/wasm-loader.js\nvar wasmSupported = (function () {\n    try {\n        if (typeof WebAssembly === 'object' && typeof WebAssembly.instantiate === 'function') {\n            var module_1 = new WebAssembly.Module(Uint8Array.of(0x0, 0x61, 0x73, 0x6d, 0x01, 0x00, 0x00, 0x00));\n            if (module_1 instanceof WebAssembly.Module)\n                return new WebAssembly.Instance(module_1) instanceof WebAssembly.Instance;\n        }\n    }\n    catch (e) { }\n    return false;\n})();\nvar loadScriptAsync = function (url, doneCallback) {\n    var tag = document.createElement('script');\n    tag.onload = function () {\n        doneCallback();\n    };\n    tag.onerror = function () {\n        throw new Error('failed to load ' + url);\n    };\n    tag.async = true;\n    tag.src = url;\n    document.head.appendChild(tag);\n};\nvar loadAmmoModule = function (path, doneCallback) {\n    // console.log(wasmSupported ? 'WebAssembly is supported' : 'WebAssembly is not supported')\n    if (wasmSupported)\n        loadScriptAsync(path + \"/ammo.wasm.js\", function () { return doneCallback(); });\n    else\n        loadScriptAsync(path + \"/ammo.js\", function () { return doneCallback(); });\n};\nexports.default = loadAmmoModule;\n//# sourceMappingURL=wasmLoader.js.map","var scope = (typeof global !== \"undefined\" && global) ||\n            (typeof self !== \"undefined\" && self) ||\n            window;\nvar apply = Function.prototype.apply;\n\n// DOM APIs, for completeness\n\nexports.setTimeout = function() {\n  return new Timeout(apply.call(setTimeout, scope, arguments), clearTimeout);\n};\nexports.setInterval = function() {\n  return new Timeout(apply.call(setInterval, scope, arguments), clearInterval);\n};\nexports.clearTimeout =\nexports.clearInterval = function(timeout) {\n  if (timeout) {\n    timeout.close();\n  }\n};\n\nfunction Timeout(id, clearFn) {\n  this._id = id;\n  this._clearFn = clearFn;\n}\nTimeout.prototype.unref = Timeout.prototype.ref = function() {};\nTimeout.prototype.close = function() {\n  this._clearFn.call(scope, this._id);\n};\n\n// Does not start the time, just sets up the members needed.\nexports.enroll = function(item, msecs) {\n  clearTimeout(item._idleTimeoutId);\n  item._idleTimeout = msecs;\n};\n\nexports.unenroll = function(item) {\n  clearTimeout(item._idleTimeoutId);\n  item._idleTimeout = -1;\n};\n\nexports._unrefActive = exports.active = function(item) {\n  clearTimeout(item._idleTimeoutId);\n\n  var msecs = item._idleTimeout;\n  if (msecs >= 0) {\n    item._idleTimeoutId = setTimeout(function onTimeout() {\n      if (item._onTimeout)\n        item._onTimeout();\n    }, msecs);\n  }\n};\n\n// setimmediate attaches itself to the global object\nrequire(\"setimmediate\");\n// On some exotic environments, it's not clear which object `setimmediate` was\n// able to install onto.  Search each possibility in the same order as the\n// `setimmediate` library.\nexports.setImmediate = (typeof self !== \"undefined\" && self.setImmediate) ||\n                       (typeof global !== \"undefined\" && global.setImmediate) ||\n                       (this && this.setImmediate);\nexports.clearImmediate = (typeof self !== \"undefined\" && self.clearImmediate) ||\n                         (typeof global !== \"undefined\" && global.clearImmediate) ||\n                         (this && this.clearImmediate);\n","(function (global, undefined) {\n    \"use strict\";\n\n    if (global.setImmediate) {\n        return;\n    }\n\n    var nextHandle = 1; // Spec says greater than zero\n    var tasksByHandle = {};\n    var currentlyRunningATask = false;\n    var doc = global.document;\n    var registerImmediate;\n\n    function setImmediate(callback) {\n      // Callback can either be a function or a string\n      if (typeof callback !== \"function\") {\n        callback = new Function(\"\" + callback);\n      }\n      // Copy function arguments\n      var args = new Array(arguments.length - 1);\n      for (var i = 0; i < args.length; i++) {\n          args[i] = arguments[i + 1];\n      }\n      // Store and register the task\n      var task = { callback: callback, args: args };\n      tasksByHandle[nextHandle] = task;\n      registerImmediate(nextHandle);\n      return nextHandle++;\n    }\n\n    function clearImmediate(handle) {\n        delete tasksByHandle[handle];\n    }\n\n    function run(task) {\n        var callback = task.callback;\n        var args = task.args;\n        switch (args.length) {\n        case 0:\n            callback();\n            break;\n        case 1:\n            callback(args[0]);\n            break;\n        case 2:\n            callback(args[0], args[1]);\n            break;\n        case 3:\n            callback(args[0], args[1], args[2]);\n            break;\n        default:\n            callback.apply(undefined, args);\n            break;\n        }\n    }\n\n    function runIfPresent(handle) {\n        // From the spec: \"Wait until any invocations of this algorithm started before this one have completed.\"\n        // So if we're currently running a task, we'll need to delay this invocation.\n        if (currentlyRunningATask) {\n            // Delay by doing a setTimeout. setImmediate was tried instead, but in Firefox 7 it generated a\n            // \"too much recursion\" error.\n            setTimeout(runIfPresent, 0, handle);\n        } else {\n            var task = tasksByHandle[handle];\n            if (task) {\n                currentlyRunningATask = true;\n                try {\n                    run(task);\n                } finally {\n                    clearImmediate(handle);\n                    currentlyRunningATask = false;\n                }\n            }\n        }\n    }\n\n    function installNextTickImplementation() {\n        registerImmediate = function(handle) {\n            process.nextTick(function () { runIfPresent(handle); });\n        };\n    }\n\n    function canUsePostMessage() {\n        // The test against `importScripts` prevents this implementation from being installed inside a web worker,\n        // where `global.postMessage` means something completely different and can't be used for this purpose.\n        if (global.postMessage && !global.importScripts) {\n            var postMessageIsAsynchronous = true;\n            var oldOnMessage = global.onmessage;\n            global.onmessage = function() {\n                postMessageIsAsynchronous = false;\n            };\n            global.postMessage(\"\", \"*\");\n            global.onmessage = oldOnMessage;\n            return postMessageIsAsynchronous;\n        }\n    }\n\n    function installPostMessageImplementation() {\n        // Installs an event handler on `global` for the `message` event: see\n        // * https://developer.mozilla.org/en/DOM/window.postMessage\n        // * http://www.whatwg.org/specs/web-apps/current-work/multipage/comms.html#crossDocumentMessages\n\n        var messagePrefix = \"setImmediate$\" + Math.random() + \"$\";\n        var onGlobalMessage = function(event) {\n            if (event.source === global &&\n                typeof event.data === \"string\" &&\n                event.data.indexOf(messagePrefix) === 0) {\n                runIfPresent(+event.data.slice(messagePrefix.length));\n            }\n        };\n\n        if (global.addEventListener) {\n            global.addEventListener(\"message\", onGlobalMessage, false);\n        } else {\n            global.attachEvent(\"onmessage\", onGlobalMessage);\n        }\n\n        registerImmediate = function(handle) {\n            global.postMessage(messagePrefix + handle, \"*\");\n        };\n    }\n\n    function installMessageChannelImplementation() {\n        var channel = new MessageChannel();\n        channel.port1.onmessage = function(event) {\n            var handle = event.data;\n            runIfPresent(handle);\n        };\n\n        registerImmediate = function(handle) {\n            channel.port2.postMessage(handle);\n        };\n    }\n\n    function installReadyStateChangeImplementation() {\n        var html = doc.documentElement;\n        registerImmediate = function(handle) {\n            // Create a <script> element; its readystatechange event will be fired asynchronously once it is inserted\n            // into the document. Do so, thus queuing up the task. Remember to clean up once it's been called.\n            var script = doc.createElement(\"script\");\n            script.onreadystatechange = function () {\n                runIfPresent(handle);\n                script.onreadystatechange = null;\n                html.removeChild(script);\n                script = null;\n            };\n            html.appendChild(script);\n        };\n    }\n\n    function installSetTimeoutImplementation() {\n        registerImmediate = function(handle) {\n            setTimeout(runIfPresent, 0, handle);\n        };\n    }\n\n    // If supported, we should attach to the prototype of global, since that is where setTimeout et al. live.\n    var attachTo = Object.getPrototypeOf && Object.getPrototypeOf(global);\n    attachTo = attachTo && attachTo.setTimeout ? attachTo : global;\n\n    // Don't get fooled by e.g. browserify environments.\n    if ({}.toString.call(global.process) === \"[object process]\") {\n        // For Node.js before 0.9\n        installNextTickImplementation();\n\n    } else if (canUsePostMessage()) {\n        // For non-IE10 modern browsers\n        installPostMessageImplementation();\n\n    } else if (global.MessageChannel) {\n        // For web workers, where supported\n        installMessageChannelImplementation();\n\n    } else if (doc && \"onreadystatechange\" in doc.createElement(\"script\")) {\n        // For IE 68\n        installReadyStateChangeImplementation();\n\n    } else {\n        // For older browsers\n        installSetTimeoutImplementation();\n    }\n\n    attachTo.setImmediate = setImmediate;\n    attachTo.clearImmediate = clearImmediate;\n}(typeof self === \"undefined\" ? typeof global === \"undefined\" ? this : global : self));\n","// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\nprocess.prependListener = noop;\nprocess.prependOnceListener = noop;\n\nprocess.listeners = function (name) { return [] }\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n'use strict';\n\nvar R = typeof Reflect === 'object' ? Reflect : null\nvar ReflectApply = R && typeof R.apply === 'function'\n  ? R.apply\n  : function ReflectApply(target, receiver, args) {\n    return Function.prototype.apply.call(target, receiver, args);\n  }\n\nvar ReflectOwnKeys\nif (R && typeof R.ownKeys === 'function') {\n  ReflectOwnKeys = R.ownKeys\n} else if (Object.getOwnPropertySymbols) {\n  ReflectOwnKeys = function ReflectOwnKeys(target) {\n    return Object.getOwnPropertyNames(target)\n      .concat(Object.getOwnPropertySymbols(target));\n  };\n} else {\n  ReflectOwnKeys = function ReflectOwnKeys(target) {\n    return Object.getOwnPropertyNames(target);\n  };\n}\n\nfunction ProcessEmitWarning(warning) {\n  if (console && console.warn) console.warn(warning);\n}\n\nvar NumberIsNaN = Number.isNaN || function NumberIsNaN(value) {\n  return value !== value;\n}\n\nfunction EventEmitter() {\n  EventEmitter.init.call(this);\n}\nmodule.exports = EventEmitter;\n\n// Backwards-compat with node 0.10.x\nEventEmitter.EventEmitter = EventEmitter;\n\nEventEmitter.prototype._events = undefined;\nEventEmitter.prototype._eventsCount = 0;\nEventEmitter.prototype._maxListeners = undefined;\n\n// By default EventEmitters will print a warning if more than 10 listeners are\n// added to it. This is a useful default which helps finding memory leaks.\nvar defaultMaxListeners = 10;\n\nfunction checkListener(listener) {\n  if (typeof listener !== 'function') {\n    throw new TypeError('The \"listener\" argument must be of type Function. Received type ' + typeof listener);\n  }\n}\n\nObject.defineProperty(EventEmitter, 'defaultMaxListeners', {\n  enumerable: true,\n  get: function() {\n    return defaultMaxListeners;\n  },\n  set: function(arg) {\n    if (typeof arg !== 'number' || arg < 0 || NumberIsNaN(arg)) {\n      throw new RangeError('The value of \"defaultMaxListeners\" is out of range. It must be a non-negative number. Received ' + arg + '.');\n    }\n    defaultMaxListeners = arg;\n  }\n});\n\nEventEmitter.init = function() {\n\n  if (this._events === undefined ||\n      this._events === Object.getPrototypeOf(this)._events) {\n    this._events = Object.create(null);\n    this._eventsCount = 0;\n  }\n\n  this._maxListeners = this._maxListeners || undefined;\n};\n\n// Obviously not all Emitters should be limited to 10. This function allows\n// that to be increased. Set to zero for unlimited.\nEventEmitter.prototype.setMaxListeners = function setMaxListeners(n) {\n  if (typeof n !== 'number' || n < 0 || NumberIsNaN(n)) {\n    throw new RangeError('The value of \"n\" is out of range. It must be a non-negative number. Received ' + n + '.');\n  }\n  this._maxListeners = n;\n  return this;\n};\n\nfunction _getMaxListeners(that) {\n  if (that._maxListeners === undefined)\n    return EventEmitter.defaultMaxListeners;\n  return that._maxListeners;\n}\n\nEventEmitter.prototype.getMaxListeners = function getMaxListeners() {\n  return _getMaxListeners(this);\n};\n\nEventEmitter.prototype.emit = function emit(type) {\n  var args = [];\n  for (var i = 1; i < arguments.length; i++) args.push(arguments[i]);\n  var doError = (type === 'error');\n\n  var events = this._events;\n  if (events !== undefined)\n    doError = (doError && events.error === undefined);\n  else if (!doError)\n    return false;\n\n  // If there is no 'error' event listener then throw.\n  if (doError) {\n    var er;\n    if (args.length > 0)\n      er = args[0];\n    if (er instanceof Error) {\n      // Note: The comments on the `throw` lines are intentional, they show\n      // up in Node's output if this results in an unhandled exception.\n      throw er; // Unhandled 'error' event\n    }\n    // At least give some kind of context to the user\n    var err = new Error('Unhandled error.' + (er ? ' (' + er.message + ')' : ''));\n    err.context = er;\n    throw err; // Unhandled 'error' event\n  }\n\n  var handler = events[type];\n\n  if (handler === undefined)\n    return false;\n\n  if (typeof handler === 'function') {\n    ReflectApply(handler, this, args);\n  } else {\n    var len = handler.length;\n    var listeners = arrayClone(handler, len);\n    for (var i = 0; i < len; ++i)\n      ReflectApply(listeners[i], this, args);\n  }\n\n  return true;\n};\n\nfunction _addListener(target, type, listener, prepend) {\n  var m;\n  var events;\n  var existing;\n\n  checkListener(listener);\n\n  events = target._events;\n  if (events === undefined) {\n    events = target._events = Object.create(null);\n    target._eventsCount = 0;\n  } else {\n    // To avoid recursion in the case that type === \"newListener\"! Before\n    // adding it to the listeners, first emit \"newListener\".\n    if (events.newListener !== undefined) {\n      target.emit('newListener', type,\n                  listener.listener ? listener.listener : listener);\n\n      // Re-assign `events` because a newListener handler could have caused the\n      // this._events to be assigned to a new object\n      events = target._events;\n    }\n    existing = events[type];\n  }\n\n  if (existing === undefined) {\n    // Optimize the case of one listener. Don't need the extra array object.\n    existing = events[type] = listener;\n    ++target._eventsCount;\n  } else {\n    if (typeof existing === 'function') {\n      // Adding the second element, need to change to array.\n      existing = events[type] =\n        prepend ? [listener, existing] : [existing, listener];\n      // If we've already got an array, just append.\n    } else if (prepend) {\n      existing.unshift(listener);\n    } else {\n      existing.push(listener);\n    }\n\n    // Check for listener leak\n    m = _getMaxListeners(target);\n    if (m > 0 && existing.length > m && !existing.warned) {\n      existing.warned = true;\n      // No error code for this since it is a Warning\n      // eslint-disable-next-line no-restricted-syntax\n      var w = new Error('Possible EventEmitter memory leak detected. ' +\n                          existing.length + ' ' + String(type) + ' listeners ' +\n                          'added. Use emitter.setMaxListeners() to ' +\n                          'increase limit');\n      w.name = 'MaxListenersExceededWarning';\n      w.emitter = target;\n      w.type = type;\n      w.count = existing.length;\n      ProcessEmitWarning(w);\n    }\n  }\n\n  return target;\n}\n\nEventEmitter.prototype.addListener = function addListener(type, listener) {\n  return _addListener(this, type, listener, false);\n};\n\nEventEmitter.prototype.on = EventEmitter.prototype.addListener;\n\nEventEmitter.prototype.prependListener =\n    function prependListener(type, listener) {\n      return _addListener(this, type, listener, true);\n    };\n\nfunction onceWrapper() {\n  if (!this.fired) {\n    this.target.removeListener(this.type, this.wrapFn);\n    this.fired = true;\n    if (arguments.length === 0)\n      return this.listener.call(this.target);\n    return this.listener.apply(this.target, arguments);\n  }\n}\n\nfunction _onceWrap(target, type, listener) {\n  var state = { fired: false, wrapFn: undefined, target: target, type: type, listener: listener };\n  var wrapped = onceWrapper.bind(state);\n  wrapped.listener = listener;\n  state.wrapFn = wrapped;\n  return wrapped;\n}\n\nEventEmitter.prototype.once = function once(type, listener) {\n  checkListener(listener);\n  this.on(type, _onceWrap(this, type, listener));\n  return this;\n};\n\nEventEmitter.prototype.prependOnceListener =\n    function prependOnceListener(type, listener) {\n      checkListener(listener);\n      this.prependListener(type, _onceWrap(this, type, listener));\n      return this;\n    };\n\n// Emits a 'removeListener' event if and only if the listener was removed.\nEventEmitter.prototype.removeListener =\n    function removeListener(type, listener) {\n      var list, events, position, i, originalListener;\n\n      checkListener(listener);\n\n      events = this._events;\n      if (events === undefined)\n        return this;\n\n      list = events[type];\n      if (list === undefined)\n        return this;\n\n      if (list === listener || list.listener === listener) {\n        if (--this._eventsCount === 0)\n          this._events = Object.create(null);\n        else {\n          delete events[type];\n          if (events.removeListener)\n            this.emit('removeListener', type, list.listener || listener);\n        }\n      } else if (typeof list !== 'function') {\n        position = -1;\n\n        for (i = list.length - 1; i >= 0; i--) {\n          if (list[i] === listener || list[i].listener === listener) {\n            originalListener = list[i].listener;\n            position = i;\n            break;\n          }\n        }\n\n        if (position < 0)\n          return this;\n\n        if (position === 0)\n          list.shift();\n        else {\n          spliceOne(list, position);\n        }\n\n        if (list.length === 1)\n          events[type] = list[0];\n\n        if (events.removeListener !== undefined)\n          this.emit('removeListener', type, originalListener || listener);\n      }\n\n      return this;\n    };\n\nEventEmitter.prototype.off = EventEmitter.prototype.removeListener;\n\nEventEmitter.prototype.removeAllListeners =\n    function removeAllListeners(type) {\n      var listeners, events, i;\n\n      events = this._events;\n      if (events === undefined)\n        return this;\n\n      // not listening for removeListener, no need to emit\n      if (events.removeListener === undefined) {\n        if (arguments.length === 0) {\n          this._events = Object.create(null);\n          this._eventsCount = 0;\n        } else if (events[type] !== undefined) {\n          if (--this._eventsCount === 0)\n            this._events = Object.create(null);\n          else\n            delete events[type];\n        }\n        return this;\n      }\n\n      // emit removeListener for all listeners on all events\n      if (arguments.length === 0) {\n        var keys = Object.keys(events);\n        var key;\n        for (i = 0; i < keys.length; ++i) {\n          key = keys[i];\n          if (key === 'removeListener') continue;\n          this.removeAllListeners(key);\n        }\n        this.removeAllListeners('removeListener');\n        this._events = Object.create(null);\n        this._eventsCount = 0;\n        return this;\n      }\n\n      listeners = events[type];\n\n      if (typeof listeners === 'function') {\n        this.removeListener(type, listeners);\n      } else if (listeners !== undefined) {\n        // LIFO order\n        for (i = listeners.length - 1; i >= 0; i--) {\n          this.removeListener(type, listeners[i]);\n        }\n      }\n\n      return this;\n    };\n\nfunction _listeners(target, type, unwrap) {\n  var events = target._events;\n\n  if (events === undefined)\n    return [];\n\n  var evlistener = events[type];\n  if (evlistener === undefined)\n    return [];\n\n  if (typeof evlistener === 'function')\n    return unwrap ? [evlistener.listener || evlistener] : [evlistener];\n\n  return unwrap ?\n    unwrapListeners(evlistener) : arrayClone(evlistener, evlistener.length);\n}\n\nEventEmitter.prototype.listeners = function listeners(type) {\n  return _listeners(this, type, true);\n};\n\nEventEmitter.prototype.rawListeners = function rawListeners(type) {\n  return _listeners(this, type, false);\n};\n\nEventEmitter.listenerCount = function(emitter, type) {\n  if (typeof emitter.listenerCount === 'function') {\n    return emitter.listenerCount(type);\n  } else {\n    return listenerCount.call(emitter, type);\n  }\n};\n\nEventEmitter.prototype.listenerCount = listenerCount;\nfunction listenerCount(type) {\n  var events = this._events;\n\n  if (events !== undefined) {\n    var evlistener = events[type];\n\n    if (typeof evlistener === 'function') {\n      return 1;\n    } else if (evlistener !== undefined) {\n      return evlistener.length;\n    }\n  }\n\n  return 0;\n}\n\nEventEmitter.prototype.eventNames = function eventNames() {\n  return this._eventsCount > 0 ? ReflectOwnKeys(this._events) : [];\n};\n\nfunction arrayClone(arr, n) {\n  var copy = new Array(n);\n  for (var i = 0; i < n; ++i)\n    copy[i] = arr[i];\n  return copy;\n}\n\nfunction spliceOne(list, index) {\n  for (; index + 1 < list.length; index++)\n    list[index] = list[index + 1];\n  list.pop();\n}\n\nfunction unwrapListeners(arr) {\n  var ret = new Array(arr.length);\n  for (var i = 0; i < ret.length; ++i) {\n    ret[i] = arr[i].listener || arr[i];\n  }\n  return ret;\n}\n","/**\n * Copied from three.js examples and added a fix\n */\n\n/**\n * @author yomboprime https://github.com/yomboprime\n *\n * @fileoverview This class can be used to subdivide a convex Geometry object into pieces.\n *\n * Usage:\n *\n * Use the function prepareBreakableObject to prepare a Mesh object to be broken.\n *\n * Then, call the various functions to subdivide the object (subdivideByImpact, cutByPlane)\n *\n * Sub-objects that are product of subdivision don't need prepareBreakableObject to be called on them.\n *\n * Requisites for the object:\n *\n *  - Mesh object must have a BufferGeometry (not Geometry) and a Material\n *\n *  - Vertex normals must be planar (not smoothed)\n *\n *  - The geometry must be convex (this is not checked in the library). You can create convex\n *  geometries with ConvexBufferGeometry. The BoxBufferGeometry, SphereBufferGeometry and other convex primitives\n *  can also be used.\n *\n * Note: This lib adds member variables to object's userData member (see prepareBreakableObject function)\n * Use with caution and read the code when using with other libs.\n *\n * @param {double} minSizeForBreak Min size a debris can have to break.\n * @param {double} smallDelta Max distance to consider that a point belongs to a plane.\n *\n */\n\nimport { Line3, Mesh, Plane, Vector3 } from '@enable3d/three-wrapper/dist/index'\nimport { ConvexBufferGeometry } from '@enable3d/three-wrapper/dist/index'\nimport logger from '@enable3d/common/dist/logger'\n\nconst ConvexObjectBreaker = function (minSizeForBreak?: number, smallDelta?: number) {\n  // @ts-ignore\n  this.minSizeForBreak = minSizeForBreak || 1.4\n  // @ts-ignore\n  this.smallDelta = smallDelta || 0.0001\n\n  // @ts-ignore\n  this.tempLine1 = new Line3()\n  // @ts-ignore\n  this.tempPlane1 = new Plane()\n  // @ts-ignore\n  this.tempPlane2 = new Plane()\n  // @ts-ignore\n  this.tempPlane_Cut = new Plane()\n  // @ts-ignore\n  this.tempCM1 = new Vector3()\n  // @ts-ignore\n  this.tempCM2 = new Vector3()\n  // @ts-ignore\n  this.tempVector3 = new Vector3()\n  // @ts-ignore\n  this.tempVector3_2 = new Vector3()\n  // @ts-ignore\n  this.tempVector3_3 = new Vector3()\n  // @ts-ignore\n  this.tempVector3_P0 = new Vector3()\n  // @ts-ignore\n  this.tempVector3_P1 = new Vector3()\n  // @ts-ignore\n  this.tempVector3_P2 = new Vector3()\n  // @ts-ignore\n  this.tempVector3_N0 = new Vector3()\n  // @ts-ignore\n  this.tempVector3_N1 = new Vector3()\n  // @ts-ignore\n  this.tempVector3_AB = new Vector3()\n  // @ts-ignore\n  this.tempVector3_CB = new Vector3()\n  // @ts-ignore\n  this.tempResultObjects = { object1: null, object2: null }\n\n  // @ts-ignore\n  this.segments = []\n  var n = 30 * 30\n  // @ts-ignore\n  for (var i = 0; i < n; i++) this.segments[i] = false\n}\n\nConvexObjectBreaker.prototype = {\n  constructor: ConvexObjectBreaker,\n\n  prepareBreakableObject: function (object: any, mass: any, velocity: any, angularVelocity: any, breakable: any) {\n    // object is a Object3d (normally a Mesh), must have a BufferGeometry, and it must be convex.\n    // Its material property is propagated to its children (sub-pieces)\n    // mass must be > 0\n\n    if (!object.geometry.isBufferGeometry) {\n      console.error('THREE.ConvexObjectBreaker.prepareBreakableObject(): Parameter object must have a BufferGeometry.')\n    }\n\n    var userData = object.userData\n    userData.mass = mass\n    userData.velocity = velocity.clone()\n    userData.angularVelocity = angularVelocity.clone()\n    userData.breakable = breakable\n  },\n\n  /*\n   * @param {int} maxRadialIterations Iterations for radial cuts.\n   * @param {int} maxRandomIterations Max random iterations for not-radial cuts\n   *\n   * Returns the array of pieces\n   */\n  subdivideByImpact: function (\n    object: any,\n    pointOfImpact: any,\n    normal: any,\n    maxRadialIterations: any,\n    maxRandomIterations: any\n  ) {\n    var debris: any = []\n\n    var tempPlane1 = this.tempPlane1\n    var tempPlane2 = this.tempPlane2\n\n    this.tempVector3.addVectors(pointOfImpact, normal)\n    tempPlane1.setFromCoplanarPoints(pointOfImpact, object.position, this.tempVector3)\n\n    var maxTotalIterations = maxRandomIterations + maxRadialIterations\n\n    var scope = this\n\n    function subdivideRadial(subObject: any, startAngle: any, endAngle: any, numIterations: any) {\n      if (Math.random() < numIterations * 0.05 || numIterations > maxTotalIterations) {\n        debris.push(subObject)\n\n        return\n      }\n\n      var angle = Math.PI\n\n      if (numIterations === 0) {\n        tempPlane2.normal.copy(tempPlane1.normal)\n        tempPlane2.constant = tempPlane1.constant\n      } else {\n        if (numIterations <= maxRadialIterations) {\n          angle = (endAngle - startAngle) * (0.2 + 0.6 * Math.random()) + startAngle\n\n          // Rotate tempPlane2 at impact point around normal axis and the angle\n          scope.tempVector3_2.copy(object.position).sub(pointOfImpact).applyAxisAngle(normal, angle).add(pointOfImpact)\n          tempPlane2.setFromCoplanarPoints(pointOfImpact, scope.tempVector3, scope.tempVector3_2)\n        } else {\n          angle = (0.5 * (numIterations & 1) + 0.2 * (2 - Math.random())) * Math.PI\n\n          // Rotate tempPlane2 at object position around normal axis and the angle\n          scope.tempVector3_2\n            .copy(pointOfImpact)\n            .sub(subObject.position)\n            .applyAxisAngle(normal, angle)\n            .add(subObject.position)\n          scope.tempVector3_3.copy(normal).add(subObject.position)\n          tempPlane2.setFromCoplanarPoints(subObject.position, scope.tempVector3_3, scope.tempVector3_2)\n        }\n      }\n\n      // Perform the cut\n      scope.cutByPlane(subObject, tempPlane2, scope.tempResultObjects)\n\n      var obj1 = scope.tempResultObjects.object1\n      var obj2 = scope.tempResultObjects.object2\n\n      if (obj1) {\n        subdivideRadial(obj1, startAngle, angle, numIterations + 1)\n      }\n\n      if (obj2) {\n        subdivideRadial(obj2, angle, endAngle, numIterations + 1)\n      }\n    }\n\n    subdivideRadial(object, 0, 2 * Math.PI, 0)\n\n    return debris\n  },\n\n  cutByPlane: function (object: any, plane: any, output: any) {\n    // Returns breakable objects in output.object1 and output.object2 members, the resulting 2 pieces of the cut.\n    // object2 can be null if the plane doesn't cut the object.\n    // object1 can be null only in case of internal error\n    // Returned value is number of pieces, 0 for error.\n\n    var geometry = object.geometry\n    var coords = geometry.attributes.position.array\n    var normals = geometry.attributes.normal.array\n\n    var numPoints = coords.length / 3\n    var numFaces = numPoints / 3\n\n    var indices = geometry.getIndex()\n\n    if (indices) {\n      indices = indices.array\n      numFaces = indices.length / 3\n    }\n\n    function getVertexIndex(faceIdx: any, vert: any) {\n      // vert = 0, 1 or 2.\n\n      var idx = faceIdx * 3 + vert\n\n      return indices ? indices[idx] : idx\n    }\n\n    var points1 = []\n    var points2 = []\n\n    var delta = this.smallDelta\n\n    // Reset segments mark\n    var numPointPairs = numPoints * numPoints\n    for (var i = 0; i < numPointPairs; i++) this.segments[i] = false\n\n    var p0 = this.tempVector3_P0\n    var p1 = this.tempVector3_P1\n    var n0 = this.tempVector3_N0\n    var n1 = this.tempVector3_N1\n\n    // Iterate through the faces to mark edges shared by coplanar faces\n    for (var i = 0; i < numFaces - 1; i++) {\n      var a1 = getVertexIndex(i, 0)\n      var b1 = getVertexIndex(i, 1)\n      var c1 = getVertexIndex(i, 2)\n\n      // Assuming all 3 vertices have the same normal\n      n0.set(normals[a1], normals[a1] + 1, normals[a1] + 2)\n\n      for (var j = i + 1; j < numFaces; j++) {\n        var a2 = getVertexIndex(j, 0)\n        var b2 = getVertexIndex(j, 1)\n        var c2 = getVertexIndex(j, 2)\n\n        // Assuming all 3 vertices have the same normal\n        n1.set(normals[a2], normals[a2] + 1, normals[a2] + 2)\n\n        var coplanar = 1 - n0.dot(n1) < delta\n\n        if (coplanar) {\n          if (a1 === a2 || a1 === b2 || a1 === c2) {\n            if (b1 === a2 || b1 === b2 || b1 === c2) {\n              this.segments[a1 * numPoints + b1] = true\n              this.segments[b1 * numPoints + a1] = true\n            } else {\n              this.segments[c1 * numPoints + a1] = true\n              this.segments[a1 * numPoints + c1] = true\n            }\n          } else if (b1 === a2 || b1 === b2 || b1 === c2) {\n            this.segments[c1 * numPoints + b1] = true\n            this.segments[b1 * numPoints + c1] = true\n          }\n        }\n      }\n    }\n\n    // Transform the plane to object local space\n    var localPlane = this.tempPlane_Cut\n    object.updateMatrix()\n    ConvexObjectBreaker.transformPlaneToLocalSpace(plane, object.matrix, localPlane)\n\n    // Iterate through the faces adding points to both pieces\n    for (var i = 0; i < numFaces; i++) {\n      var va = getVertexIndex(i, 0)\n      var vb = getVertexIndex(i, 1)\n      var vc = getVertexIndex(i, 2)\n\n      for (var segment = 0; segment < 3; segment++) {\n        var i0 = segment === 0 ? va : segment === 1 ? vb : vc\n        var i1 = segment === 0 ? vb : segment === 1 ? vc : va\n\n        var segmentState = this.segments[i0 * numPoints + i1]\n\n        if (segmentState) continue // The segment already has been processed in another face\n\n        // Mark segment as processed (also inverted segment)\n        this.segments[i0 * numPoints + i1] = true\n        this.segments[i1 * numPoints + i0] = true\n\n        p0.set(coords[3 * i0], coords[3 * i0 + 1], coords[3 * i0 + 2])\n        p1.set(coords[3 * i1], coords[3 * i1 + 1], coords[3 * i1 + 2])\n\n        // mark: 1 for negative side, 2 for positive side, 3 for coplanar point\n        var mark0 = 0\n\n        var d = localPlane.distanceToPoint(p0)\n\n        if (d > delta) {\n          mark0 = 2\n          points2.push(p0.clone())\n        } else if (d < -delta) {\n          mark0 = 1\n          points1.push(p0.clone())\n        } else {\n          mark0 = 3\n          points1.push(p0.clone())\n          points2.push(p0.clone())\n        }\n\n        // mark: 1 for negative side, 2 for positive side, 3 for coplanar point\n        var mark1 = 0\n\n        var d = localPlane.distanceToPoint(p1)\n\n        if (d > delta) {\n          mark1 = 2\n          points2.push(p1.clone())\n        } else if (d < -delta) {\n          mark1 = 1\n          points1.push(p1.clone())\n        } else {\n          mark1 = 3\n          points1.push(p1.clone())\n          points2.push(p1.clone())\n        }\n\n        if ((mark0 === 1 && mark1 === 2) || (mark0 === 2 && mark1 === 1)) {\n          // Intersection of segment with the plane\n\n          this.tempLine1.start.copy(p0)\n          this.tempLine1.end.copy(p1)\n\n          var intersection = new Vector3()\n          intersection = localPlane.intersectLine(this.tempLine1, intersection)\n\n          if (intersection === undefined) {\n            // Shouldn't happen\n            console.error('Internal error: segment does not intersect plane.')\n            output.segmentedObject1 = null\n            output.segmentedObject2 = null\n            return 0\n          }\n\n          points1.push(intersection)\n          points2.push(intersection.clone())\n        }\n      }\n    }\n\n    // Calculate debris mass (very fast and imprecise):\n    var newMass = object.userData.mass * 0.5\n\n    // Calculate debris Center of Mass (again fast and imprecise)\n    this.tempCM1.set(0, 0, 0)\n    var radius1 = 0\n    var numPoints1 = points1.length\n\n    if (numPoints1 > 0) {\n      for (var i = 0; i < numPoints1; i++) this.tempCM1.add(points1[i])\n\n      this.tempCM1.divideScalar(numPoints1)\n      for (var i = 0; i < numPoints1; i++) {\n        var p = points1[i]\n        p.sub(this.tempCM1)\n        radius1 = Math.max(radius1, p.x, p.y, p.z)\n      }\n      this.tempCM1.add(object.position)\n    }\n\n    this.tempCM2.set(0, 0, 0)\n    var radius2 = 0\n    var numPoints2 = points2.length\n    if (numPoints2 > 0) {\n      for (var i = 0; i < numPoints2; i++) this.tempCM2.add(points2[i])\n\n      this.tempCM2.divideScalar(numPoints2)\n      for (var i = 0; i < numPoints2; i++) {\n        var p = points2[i]\n        p.sub(this.tempCM2)\n        radius2 = Math.max(radius2, p.x, p.y, p.z)\n      }\n      this.tempCM2.add(object.position)\n    }\n\n    var object1 = null\n    var object2 = null\n\n    var numObjects = 0\n\n    /**\n     * MOD: Wrapped in try catch block to avoid errors\n     */\n    if (numPoints1 > 4) {\n      try {\n        object1 = new Mesh(new ConvexBufferGeometry(points1), object.material)\n        object1.position.copy(this.tempCM1)\n        object1.quaternion.copy(object.quaternion)\n\n        this.prepareBreakableObject(\n          object1,\n          newMass,\n          object.userData.velocity,\n          object.userData.angularVelocity,\n          2 * radius1 > this.minSizeForBreak\n        )\n\n        numObjects++\n      } catch (error) {\n        logger('Error in ConvexObjectBreaker.ts')\n      }\n    }\n\n    if (numPoints2 > 4) {\n      try {\n        object2 = new Mesh(new ConvexBufferGeometry(points2), object.material)\n        object2.position.copy(this.tempCM2)\n        object2.quaternion.copy(object.quaternion)\n\n        this.prepareBreakableObject(\n          object2,\n          newMass,\n          object.userData.velocity,\n          object.userData.angularVelocity,\n          2 * radius2 > this.minSizeForBreak\n        )\n\n        numObjects++\n      } catch (error) {\n        logger('Error in ConvexObjectBreaker.ts')\n      }\n    }\n\n    output.object1 = object1\n    output.object2 = object2\n\n    return numObjects\n  }\n}\n\nConvexObjectBreaker.transformFreeVector = function (v: any, m: any) {\n  // input:\n  // vector interpreted as a free vector\n  // THREE.Matrix4 orthogonal matrix (matrix without scale)\n\n  var x = v.x,\n    y = v.y,\n    z = v.z\n  var e = m.elements\n\n  v.x = e[0] * x + e[4] * y + e[8] * z\n  v.y = e[1] * x + e[5] * y + e[9] * z\n  v.z = e[2] * x + e[6] * y + e[10] * z\n\n  return v\n}\n\nConvexObjectBreaker.transformFreeVectorInverse = function (v: any, m: any) {\n  // input:\n  // vector interpreted as a free vector\n  // THREE.Matrix4 orthogonal matrix (matrix without scale)\n\n  var x = v.x,\n    y = v.y,\n    z = v.z\n  var e = m.elements\n\n  v.x = e[0] * x + e[1] * y + e[2] * z\n  v.y = e[4] * x + e[5] * y + e[6] * z\n  v.z = e[8] * x + e[9] * y + e[10] * z\n\n  return v\n}\n\nConvexObjectBreaker.transformTiedVectorInverse = function (v: any, m: any) {\n  // input:\n  // vector interpreted as a tied (ordinary) vector\n  // THREE.Matrix4 orthogonal matrix (matrix without scale)\n\n  var x = v.x,\n    y = v.y,\n    z = v.z\n  var e = m.elements\n\n  v.x = e[0] * x + e[1] * y + e[2] * z - e[12]\n  v.y = e[4] * x + e[5] * y + e[6] * z - e[13]\n  v.z = e[8] * x + e[9] * y + e[10] * z - e[14]\n\n  return v\n}\n\nConvexObjectBreaker.transformPlaneToLocalSpace = (function () {\n  var v1 = new Vector3()\n\n  return function transformPlaneToLocalSpace(plane: any, m: any, resultPlane: any) {\n    resultPlane.normal.copy(plane.normal)\n    resultPlane.constant = plane.constant\n\n    var referencePoint = ConvexObjectBreaker.transformTiedVectorInverse(plane.coplanarPoint(v1), m)\n\n    ConvexObjectBreaker.transformFreeVectorInverse(resultPlane.normal, m)\n\n    // recalculate constant (like in setFromNormalAndCoplanarPoint)\n    resultPlane.constant = -referencePoint.dot(resultPlane.normal)\n  }\n})()\n\nexport { ConvexObjectBreaker }\n","/**\n * @author       Yannick Deubel (https://github.com/yandeu)\n * @copyright    Copyright (c) 2020 Yannick Deubel; Project Url: https://github.com/enable3d/enable3d\n * @license      {@link https://github.com/enable3d/enable3d/blob/master/LICENSE|GNU GPLv3}\n */\n\nimport { AmmoPhysics } from '.'\nimport { ExtendedObject3D } from '@enable3d/common/dist/types'\n\nimport EventEmitter from 'eventemitter3'\nimport { Euler, Quaternion } from '@enable3d/three-wrapper/dist/index'\n\nclass PhysicsBody {\n  public offset = { x: 0, y: 0, z: 0 }\n  public name: string\n  public errors: string[] = []\n  public checkCollisions = false\n  public breakable = false\n  public collided = false\n  public didUpdate = false\n\n  private _emitUpdateEvents = false\n  private _needUpdate = false\n\n  private tmpEuler = new Euler()\n  private tmpQuaternion = new Quaternion()\n  private tmpBtVector3 = new Ammo.btVector3()\n  private tmpBtQuaternion = new Ammo.btQuaternion(0, 0, 0, 1)\n\n  private eventEmitter: EventEmitter\n\n  constructor(private physics: AmmoPhysics, public ammo: Ammo.btRigidBody) {\n    // @ts-ignore\n    this.name = ammo.name\n  }\n\n  private setupEventEmitter() {\n    if (typeof this.eventEmitter === 'undefined') this.eventEmitter = new EventEmitter()\n  }\n\n  public get needUpdate() {\n    return this._needUpdate\n  }\n  public set needUpdate(need: boolean) {\n    if (!need && this._needUpdate) this.didUpdate = true\n    this._needUpdate = need\n  }\n\n  private onUpdateEvent(updateCallback: Function, once: boolean = false) {\n    this.setupEventEmitter()\n    this._emitUpdateEvents = true\n    if (once)\n      this.eventEmitter.once('update', () => {\n        updateCallback()\n      })\n    else\n      this.eventEmitter.on('update', () => {\n        updateCallback()\n      })\n  }\n\n  public get on() {\n    return {\n      update: (updateCallback: Function) => this.onUpdateEvent(updateCallback),\n      collision: (collisionCallback: (otherObject: ExtendedObject3D, event: 'start' | 'collision' | 'end') => void) =>\n        this.onCollision(collisionCallback)\n    }\n  }\n\n  public get once() {\n    return {\n      update: (updateCallback: Function) => this.onUpdateEvent(updateCallback, true)\n    }\n  }\n\n  private onCollision(\n    collisionCallback: (otherObject: ExtendedObject3D, event: 'start' | 'collision' | 'end') => void\n  ) {\n    this.checkCollisions = true\n\n    this.physics.on('collision', (data: { bodies: ExtendedObject3D[]; event: 'start' | 'collision' | 'end' }) => {\n      const { bodies, event } = data\n      if (bodies[0].name === this.name) collisionCallback(bodies[1], event)\n      else if (bodies[1].name === this.name) collisionCallback(bodies[0], event)\n    })\n  }\n\n  /** You have to call transform() before you can get or set the body's position or rotation. (for headless mode only) */\n  public transform() {\n    const t = this.physics.tmpTrans\n    this.ammo.getMotionState().getWorldTransform(t)\n  }\n\n  /** You have to call refresh() after you set the position or rotation of the body. (for headless mode only) */\n  public refresh() {\n    const t = this.physics.tmpTrans\n    this.ammo.getMotionState().setWorldTransform(t)\n  }\n\n  /** Set the rotation in radians. (for headless mode only) */\n  public setRotation(x: number, y: number, z: number) {\n    const e = this.tmpEuler.set(x, y, z)\n    const q = this.tmpQuaternion.set(0, 0, 0, 1)\n    q.setFromEuler(e)\n\n    this.tmpBtQuaternion.setValue(0, 0, 0, 1)\n    const ammoQuat = this.tmpBtQuaternion\n    ammoQuat.setValue(q.x, q.y, q.z, q.w)\n\n    const t = this.physics.tmpTrans\n    t.setRotation(ammoQuat)\n  }\n\n  /** Get the rotation in radians. (for headless mode only) */\n  public get rotation() {\n    const t = this.physics.tmpTrans\n    const ammoQuat = t.getRotation()\n    const q = this.tmpQuaternion.set(ammoQuat.x(), ammoQuat.y(), ammoQuat.z(), ammoQuat.w())\n\n    const qx = q.x\n    const qy = q.y\n    const qz = q.z\n    const qw = q.w\n\n    // https://www.euclideanspace.com/maths/geometry/rotations/conversions/quaternionToAngle/index.htm\n    const angle = 2 * Math.acos(qw)\n    const x = qx / Math.sqrt(1 - qw * qw)\n    const y = qy / Math.sqrt(1 - qw * qw)\n    const z = qz / Math.sqrt(1 - qw * qw)\n\n    return { x: x * angle || 0, y: y * angle || 0, z: z * angle || 0 }\n  }\n\n  public setPosition(x: number, y: number, z: number) {\n    const t = this.physics.tmpTrans\n    t.getOrigin().setValue(x, y, z)\n  }\n\n  public get position() {\n    const t = this.physics.tmpTrans\n    return { x: t.getOrigin().x(), y: t.getOrigin().y(), z: t.getOrigin().z() }\n  }\n\n  public get velocity() {\n    return {\n      x: this.ammo.getLinearVelocity().x(),\n      y: this.ammo.getLinearVelocity().y(),\n      z: this.ammo.getLinearVelocity().z()\n    }\n  }\n\n  public get angularVelocity() {\n    return {\n      x: this.ammo.getAngularVelocity().x(),\n      y: this.ammo.getAngularVelocity().y(),\n      z: this.ammo.getAngularVelocity().z()\n    }\n  }\n\n  public setVelocity(x: number, y: number, z: number) {\n    this.tmpBtVector3.setValue(x, y, z)\n    this.ammo.setLinearVelocity(this.tmpBtVector3)\n  }\n  public setVelocityX(value: number) {\n    this.tmpBtVector3.setValue(value, this.velocity.y, this.velocity.z)\n    this.ammo.setLinearVelocity(this.tmpBtVector3)\n  }\n  public setVelocityY(value: number) {\n    this.tmpBtVector3.setValue(this.velocity.x, value, this.velocity.z)\n    this.ammo.setLinearVelocity(this.tmpBtVector3)\n  }\n  public setVelocityZ(value: number) {\n    this.tmpBtVector3.setValue(this.velocity.x, this.velocity.y, value)\n    this.ammo.setLinearVelocity(this.tmpBtVector3)\n  }\n\n  public setAngularVelocity(x: number, y: number, z: number) {\n    this.tmpBtVector3.setValue(x, y, z)\n    this.ammo.setAngularVelocity(this.tmpBtVector3)\n  }\n  public setAngularVelocityX(value: number) {\n    this.tmpBtVector3.setValue(value, this.angularVelocity.y, this.angularVelocity.z)\n    this.ammo.setAngularVelocity(this.tmpBtVector3)\n  }\n  public setAngularVelocityY(value: number) {\n    this.tmpBtVector3.setValue(this.angularVelocity.x, value, this.angularVelocity.z)\n    this.ammo.setAngularVelocity(this.tmpBtVector3)\n  }\n  public setAngularVelocityZ(value: number) {\n    this.tmpBtVector3.setValue(this.angularVelocity.x, this.angularVelocity.y, value)\n    this.ammo.setAngularVelocity(this.tmpBtVector3)\n  }\n\n  public applyForce(x: number, y: number, z: number) {\n    this.tmpBtVector3.setValue(x, y, z)\n    this.ammo.applyCentralImpulse(this.tmpBtVector3)\n  }\n  public applyForceX(value: number) {\n    this.tmpBtVector3.setValue(value, 0, 0)\n    this.ammo.applyCentralImpulse(this.tmpBtVector3)\n  }\n  public applyForceY(value: number) {\n    this.tmpBtVector3.setValue(0, value, 0)\n    this.ammo.applyCentralImpulse(this.tmpBtVector3)\n  }\n  public applyForceZ(value: number) {\n    this.tmpBtVector3.setValue(0, 0, value)\n    this.ammo.applyCentralImpulse(this.tmpBtVector3)\n  }\n\n  /**\n   * Add the collision flags\n   * @param value 0 is DYNAMIC, 1 is STATIC, 2 is KINEMATIC, 4 GHOST\n   */\n  // https://github.com/bulletphysics/bullet3/blob/aae8048722f2596f7e2bdd52d2a1dcb52a218f2b/src/BulletCollision/CollisionDispatch/btCollisionObject.h#L128\n  public setCollisionFlags(value: number) {\n    this.ammo.setCollisionFlags(value)\n  }\n  /**\n   * Get the collision flags\n   * @param value 0 is DYNAMIC, 1 is STATIC, 2 is KINEMATIC, 4 GHOST\n   */\n  public getCollisionFlags() {\n    return this.ammo.getCollisionFlags()\n  }\n\n  /**\n   * Set the restitution (same as bounciness)\n   * @param value A number from 0 to 1.\n   */\n  public setRestitution(value: number) {\n    this.ammo.setRestitution(value)\n  }\n  /**\n   * Set the bounciness (same as restitution)\n   * @param value A number from 0 to 1.\n   */\n  public setBounciness(value: number) {\n    this.setRestitution(value)\n  }\n\n  /**\n   * Set the friction\n   * @param value A number from 0 to 1.\n   */\n  public setFriction(value: number) {\n    this.ammo.setFriction(value)\n  }\n\n  public setLinearFactor(x: number, y: number, z: number) {\n    this.tmpBtVector3.setValue(x, y, z)\n    this.ammo.setLinearFactor(this.tmpBtVector3)\n  }\n  public setAngularFactor(x: number, y: number, z: number) {\n    this.tmpBtVector3.setValue(x, y, z)\n    this.ammo.setAngularFactor(this.tmpBtVector3)\n  }\n\n  public setCcdMotionThreshold(threshold: number) {\n    this.ammo.setCcdMotionThreshold(threshold)\n  }\n\n  public setCcdSweptSphereRadius(radius: number) {\n    this.ammo.setCcdSweptSphereRadius(radius)\n  }\n}\n\nexport default PhysicsBody\n","/**\n * @author       Yannick Deubel (https://github.com/yandeu)\n * @copyright    Copyright (c) 2020 Yannick Deubel; Project Url: https://github.com/enable3d/enable3d\n * @license      {@link https://github.com/enable3d/enable3d/blob/master/LICENSE|GNU GPLv3}\n */\n\nimport {\n  SphereConfig,\n  MaterialConfig,\n  BoxConfig,\n  GroundConfig,\n  CylinderConfig,\n  ExtendedObject3D,\n  ExtrudeConfig,\n  TorusConfig,\n  AddExistingConfig,\n  PlaneConfig,\n  ConeConfig\n} from '@enable3d/common/dist/types'\nimport Factories from '@enable3d/common/dist/factories'\n\ninterface Shapes {}\n\nclass Shapes {\n  public tmpTrans: Ammo.btTransform\n  public physicsWorld: Ammo.btDiscreteDynamicsWorld\n  protected objectsAmmo: { [ptr: number]: any } = {}\n  protected addExisting: (object: ExtendedObject3D, config?: AddExistingConfig) => void\n  protected factory: Factories\n\n  protected addPlane(planeConfig: PlaneConfig = {}, materialConfig: MaterialConfig = {}) {\n    const plane = this.factory.add.plane(planeConfig, materialConfig)\n    this.addExisting(plane, planeConfig)\n    return plane\n  }\n\n  protected addSphere(sphereConfig: SphereConfig = {}, materialConfig: MaterialConfig = {}) {\n    const sphere = this.factory.add.sphere(sphereConfig, materialConfig)\n    this.addExisting(sphere, sphereConfig)\n    return sphere\n  }\n\n  protected addBox(boxConfig: BoxConfig = {}, materialConfig: MaterialConfig = {}) {\n    const box = this.factory.add.box(boxConfig, materialConfig)\n    this.addExisting(box, boxConfig)\n    return box\n  }\n\n  protected addGround(groundConfig: GroundConfig, materialConfig: MaterialConfig = {}) {\n    const ground = this.factory.add.ground(groundConfig, materialConfig)\n    const config = { ...groundConfig, mass: 0, collisionFlags: 1 }\n    this.addExisting(ground, config)\n    return ground\n  }\n\n  protected addCylinder(cylinderConfig: CylinderConfig = {}, materialConfig: MaterialConfig = {}) {\n    const cylinder = this.factory.add.cylinder(cylinderConfig, materialConfig)\n    this.addExisting(cylinder, cylinderConfig)\n    return cylinder\n  }\n\n  protected addCone(coneConfig: ConeConfig = {}, materialConfig: MaterialConfig = {}) {\n    const cone = this.factory.add.cone(coneConfig, materialConfig)\n    this.addExisting(cone, coneConfig)\n    return cone\n  }\n\n  protected addTorus(torusConfig: TorusConfig = {}, materialConfig: MaterialConfig = {}) {\n    const torus = this.factory.add.torus(torusConfig, materialConfig)\n    this.addExisting(torus, torusConfig)\n    return torus\n  }\n\n  protected addExtrude(extrudeConfig: ExtrudeConfig, materialConfig: MaterialConfig = {}) {\n    const object = this.factory.add.extrude(extrudeConfig, materialConfig)\n    object.translateX(1)\n    this.addExisting(object)\n    return object\n  }\n}\n\nexport default Shapes\n","/**\n * @author       Yannick Deubel (https://github.com/yandeu)\n * @copyright    Copyright (c) 2020 Yannick Deubel; Project Url: https://github.com/enable3d/enable3d\n * @license      {@link https://github.com/enable3d/enable3d/blob/master/LICENSE|GNU GPLv3}\n */\n\n// Inspired by https://github.com/donmccurdy/aframe-physics-system/blob/master/src/components/ammo-constraint.js\n\nimport PhysicsBody from './physicsBody'\nimport { XYZ } from '@enable3d/common/dist/types'\n\nexport default class Constraints {\n  public tmpTrans: Ammo.btTransform\n  public physicsWorld: Ammo.btDiscreteDynamicsWorld\n\n  constructor() {}\n  protected get addConstraints() {\n    return {\n      lock: (body: PhysicsBody, targetBody: PhysicsBody) => this.lock(body, targetBody),\n      fixed: (body: PhysicsBody, targetBody: PhysicsBody) => this.fixed(body, targetBody),\n      spring: (\n        body: PhysicsBody,\n        targetBody: PhysicsBody,\n        config: {\n          stiffness?: number\n          damping?: number\n          angularLock?: boolean\n        }\n      ) => this.spring(body, targetBody, config),\n      slider: (body: PhysicsBody, targetBody: PhysicsBody) => this.slider(body, targetBody),\n      hinge: (\n        body: PhysicsBody,\n        targetBody: PhysicsBody,\n        config: {\n          pivot?: XYZ\n          targetPivot?: XYZ\n          axis?: XYZ\n          targetAxis?: XYZ\n        }\n      ) => this.hinge(body, targetBody, config),\n      coneTwist: (body: PhysicsBody, targetPivot: XYZ) => this.coneTwist(body, targetPivot),\n      pointToPoint: (\n        body: PhysicsBody,\n        targetBody: PhysicsBody,\n        config: {\n          pivot?: XYZ\n          targetPivot?: XYZ\n        }\n      ) => this.pointToPoint(body, targetBody, config)\n    }\n  }\n\n  private getTransform(body: Ammo.btRigidBody, targetBody: Ammo.btRigidBody) {\n    const bodyTransform = body.getCenterOfMassTransform().inverse().op_mul(targetBody.getWorldTransform())\n    const targetTransform = new Ammo.btTransform()\n    targetTransform.setIdentity()\n    return { body: bodyTransform, target: targetTransform }\n  }\n\n  private lock(body: PhysicsBody, targetBody: PhysicsBody) {\n    const transform = this.getTransform(body.ammo, targetBody.ammo)\n    const constraint = new Ammo.btGeneric6DofConstraint(\n      body.ammo,\n      targetBody.ammo,\n      transform.body,\n      transform.target,\n      true\n    )\n    const zero = new Ammo.btVector3(0, 0, 0)\n    //TODO: allow these to be configurable\n    constraint.setLinearLowerLimit(zero)\n    constraint.setLinearUpperLimit(zero)\n    constraint.setAngularLowerLimit(zero)\n    constraint.setAngularUpperLimit(zero)\n    this.physicsWorld.addConstraint(constraint)\n  }\n\n  private fixed(body: PhysicsBody, targetBody: PhysicsBody) {\n    const transform = this.getTransform(body.ammo, targetBody.ammo)\n    transform.body.setRotation(body.ammo.getWorldTransform().getRotation())\n    transform.target.setRotation(targetBody.ammo.getWorldTransform().getRotation())\n    const constraint = new Ammo.btFixedConstraint(body.ammo, targetBody.ammo, transform.body, transform.target)\n    this.physicsWorld.addConstraint(constraint)\n  }\n\n  private spring(\n    body: PhysicsBody,\n    targetBody: PhysicsBody,\n    config: {\n      stiffness?: number\n      damping?: number\n      angularLock?: boolean\n    } = {}\n  ) {\n    const { stiffness = 50, damping = 0.01, angularLock = false } = config\n\n    const transform = this.getTransform(body.ammo, targetBody.ammo)\n    const constraint = new Ammo.btGeneric6DofSpringConstraint(\n      body.ammo,\n      targetBody.ammo,\n      transform.body,\n      transform.target,\n      true\n    )\n\n    constraint.setLinearLowerLimit(new Ammo.btVector3(-100, -100, -100))\n    constraint.setLinearUpperLimit(new Ammo.btVector3(100, 100, 100))\n\n    if (angularLock) {\n      constraint.setAngularLowerLimit(new Ammo.btVector3(0, 0, 0))\n      constraint.setAngularUpperLimit(new Ammo.btVector3(0, 0, 0))\n    }\n\n    for (let i = 0; i < 3; i++) {\n      constraint.enableSpring(i, true)\n      constraint.setStiffness(i, stiffness)\n      constraint.setDamping(i, damping)\n    }\n    // I have no idea what setEquilibriumPoint does :/\n    // constraint.setEquilibriumPoint()\n    this.physicsWorld.addConstraint(constraint)\n  }\n\n  private slider(body: PhysicsBody, targetBody: PhysicsBody) {\n    const transform = this.getTransform(body.ammo, targetBody.ammo)\n    //TODO: support setting linear and angular limits\n    const constraint = new Ammo.btSliderConstraint(body.ammo, targetBody.ammo, transform.body, transform.target, true)\n    constraint.setLowerLinLimit(-1)\n    constraint.setUpperLinLimit(1)\n    // constraint.setLowerAngLimit();\n    // constraint.setUpperAngLimit();\n    this.physicsWorld.addConstraint(constraint)\n  }\n\n  private hinge(\n    body: PhysicsBody,\n    targetBody: PhysicsBody,\n    config: {\n      pivot?: XYZ\n      targetPivot?: XYZ\n      axis?: XYZ\n      targetAxis?: XYZ\n    } = {}\n  ) {\n    const { pivot, targetPivot, axis, targetAxis } = config\n    const pivotV3 = new Ammo.btVector3(pivot?.x || 0, pivot?.y || 0, pivot?.z || 0)\n    const targetPivotV3 = new Ammo.btVector3(targetPivot?.x || 0, targetPivot?.y || 0, targetPivot?.z || 0)\n    const axisV3 = new Ammo.btVector3(axis?.x || 0, axis?.y || 0, axis?.z || 1)\n    const targetAxisV3 = new Ammo.btVector3(targetAxis?.x || 0, targetAxis?.y || 0, targetAxis?.z || 1)\n    const constraint = new Ammo.btHingeConstraint(\n      body.ammo,\n      targetBody.ammo,\n      pivotV3,\n      targetPivotV3,\n      axisV3,\n      targetAxisV3,\n      true\n    )\n    this.physicsWorld.addConstraint(constraint)\n  }\n\n  private coneTwist(body: PhysicsBody, targetPivot: XYZ = {}) {\n    const pivotTransform = new Ammo.btTransform()\n    pivotTransform.setIdentity()\n    pivotTransform.getOrigin().setValue(targetPivot?.x || 0, targetPivot?.y || 0, targetPivot?.z || 0)\n    const constraint = new Ammo.btConeTwistConstraint(body.ammo, pivotTransform)\n    this.physicsWorld.addConstraint(constraint)\n  }\n\n  private pointToPoint(\n    body: PhysicsBody,\n    targetBody: PhysicsBody,\n    config: {\n      pivot?: XYZ\n      targetPivot?: XYZ\n    } = {}\n  ) {\n    const { pivot, targetPivot } = config\n    const pivotV3 = new Ammo.btVector3(pivot?.x || 0, pivot?.y || 0, pivot?.z || 0)\n    const targetPivotV3 = new Ammo.btVector3(targetPivot?.x || 0, targetPivot?.y || 0, targetPivot?.z || 0)\n    const constraint = new Ammo.btPoint2PointConstraint(body.ammo, targetBody.ammo, pivotV3, targetPivotV3)\n    this.physicsWorld.addConstraint(constraint)\n  }\n}\n","/**\n * @author       Yannick Deubel (https://github.com/yandeu)\n * @copyright    Copyright (c) 2020 Yannick Deubel; Project Url: https://github.com/enable3d/enable3d\n * @license      {@link https://github.com/enable3d/enable3d/blob/master/LICENSE|GNU GPLv3}\n */\n\nimport EventEmitter from 'eventemitter3'\nimport { ExtendedObject3D } from '@enable3d/common/dist/types'\n\nexport default class Events extends EventEmitter {\n  public tmpTrans: Ammo.btTransform\n  public physicsWorld: Ammo.btDiscreteDynamicsWorld\n\n  protected addCollider(\n    object1: ExtendedObject3D,\n    object2: ExtendedObject3D,\n    eventCallback: (event: 'start' | 'collision' | 'end') => void\n  ) {\n    if (!object1.body || !object2.body) return\n\n    object1.body.checkCollisions = true\n    object2.body.checkCollisions = true\n\n    this.on('collision', data => {\n      const { bodies, event } = data\n      if (bodies[0]?.name && bodies[1]?.name && object1?.name && object2?.name) {\n        if (bodies[0].name === object1.name && bodies[1].name === object2.name) eventCallback(event)\n        else if (bodies[1].name === object1.name && bodies[0].name === object2.name) eventCallback(event)\n      }\n    })\n  }\n}\n","/**\n * @author       Yannick Deubel (https://github.com/yandeu)\n * @copyright    Copyright (c) 2020 Yannick Deubel; Project Url: https://github.com/enable3d/enable3d\n * @description  This is a modified version of the original code from Kevin Lee\n */\n\n/**\n * @author       Kevin Lee (https://github.com/InfiniteLee)\n * @copyright    Copyright (c) 2019 Kevin Lee; Project Url: https://github.com/InfiniteLee/ammo-debug-drawer\n * @license      {@link https://github.com/InfiniteLee/ammo-debug-drawer/blob/master/LICENSE|MPL-2.0}\n */\n\nimport {\n  Scene,\n  BufferGeometry,\n  BufferAttribute,\n  LineBasicMaterial,\n  LineSegments,\n  StaticDrawUsage\n} from '@enable3d/three-wrapper/dist/index'\n\nconst AmmoDebugConstants = {\n  NoDebug: 0,\n  DrawWireframe: 1,\n  DrawAabb: 2,\n  DrawFeaturesText: 4,\n  DrawContactPoints: 8,\n  NoDeactivation: 16,\n  NoHelpText: 32,\n  DrawText: 64,\n  ProfileTimings: 128,\n  EnableSatComparison: 256,\n  DisableBulletLCP: 512,\n  EnableCCD: 1024,\n  DrawConstraints: 1 << 11, //2048\n  DrawConstraintLimits: 1 << 12, //4096\n  FastWireframe: 1 << 13, //8192\n  DrawNormals: 1 << 14, //16384\n  DrawOnTop: 1 << 15, //32768\n  MAX_DEBUG_DRAW_MODE: 0xffffffff\n}\n\n/**\n * An implementation of the btIDebugDraw interface in Ammo.js, for debug rendering of Ammo shapes\n */\nclass DebugDrawer {\n  debugDrawMode: number\n  geometry: BufferGeometry\n  index: number\n  mesh: LineSegments\n  enabled: boolean\n  debugDrawer: Ammo.DebugDrawer\n  warnedOnce: boolean\n  constructor(public scene: Scene, public world: Ammo.btCollisionWorld, public options: any = {}) {\n    this.debugDrawMode = options.debugDrawMode || AmmoDebugConstants.DrawWireframe\n    const drawOnTop = this.debugDrawMode & AmmoDebugConstants.DrawOnTop || false\n    const maxBufferSize = options.maxBufferSize || 1000000\n\n    this.geometry = new BufferGeometry()\n    const vertices = new Float32Array(maxBufferSize * 3)\n    const colors = new Float32Array(maxBufferSize * 3)\n\n    /*\n    I do not know the difference, just using the first one.\n    export const StaticDrawUsage: Usage;\n    export const DynamicDrawUsage: Usage;\n    export const StreamDrawUsage: Usage;\n    export const StaticReadUsage: Usage;\n    export const DynamicReadUsage: Usage;\n    export const StreamReadUsage: Usage;\n    export const StaticCopyUsage: Usage;\n    export const DynamicCopyUsage: Usage;\n    export const StreamCopyUsage: Usage;\n     */\n    this.geometry.setAttribute('position', new BufferAttribute(vertices, 3).setUsage(StaticDrawUsage))\n    this.geometry.setAttribute('color', new BufferAttribute(colors, 3).setUsage(StaticDrawUsage))\n\n    this.index = 0\n\n    const material = new LineBasicMaterial({\n      vertexColors: true,\n      depthTest: !drawOnTop\n    })\n\n    this.mesh = new LineSegments(this.geometry, material)\n    if (drawOnTop) this.mesh.renderOrder = 999\n    this.mesh.frustumCulled = false\n\n    this.enabled = false\n\n    this.debugDrawer = new Ammo.DebugDrawer()\n    this.debugDrawer.drawLine = this.drawLine.bind(this)\n    this.debugDrawer.drawContactPoint = this.drawContactPoint.bind(this)\n    this.debugDrawer.reportErrorWarning = this.reportErrorWarning.bind(this)\n    this.debugDrawer.draw3dText = this.draw3dText.bind(this)\n    this.debugDrawer.setDebugMode = this.setDebugMode.bind(this)\n    this.debugDrawer.getDebugMode = this.getDebugMode.bind(this)\n\n    this.world.setDebugDrawer(this.debugDrawer)\n  }\n\n  enable() {\n    this.enabled = true\n    this.scene.add(this.mesh)\n  }\n\n  disable() {\n    this.enabled = false\n    this.scene.remove(this.mesh)\n  }\n\n  update() {\n    if (!this.enabled) {\n      return\n    }\n\n    if (this.index != 0) {\n      // @ts-ignore\n      this.geometry.attributes.position.needsUpdate = true\n      // @ts-ignore\n      this.geometry.attributes.color.needsUpdate = true\n    }\n\n    this.index = 0\n    this.world.debugDrawWorld()\n    this.geometry.setDrawRange(0, this.index)\n  }\n\n  drawLine(from: any, to: any, color: any) {\n    // @ts-ignore\n    const heap = Ammo.HEAPF32\n    const r = heap[(color + 0) / 4]\n    const g = heap[(color + 4) / 4]\n    const b = heap[(color + 8) / 4]\n\n    const fromX = heap[(from + 0) / 4]\n    const fromY = heap[(from + 4) / 4]\n    const fromZ = heap[(from + 8) / 4]\n    this.geometry.attributes.position.setXYZ(this.index, fromX, fromY, fromZ)\n    this.geometry.attributes.color.setXYZ(this.index++, r, g, b)\n\n    const toX = heap[(to + 0) / 4]\n    const toY = heap[(to + 4) / 4]\n    const toZ = heap[(to + 8) / 4]\n    this.geometry.attributes.position.setXYZ(this.index, toX, toY, toZ)\n    this.geometry.attributes.color.setXYZ(this.index++, r, g, b)\n  }\n\n  //TODO: figure out how to make lifeTime work\n  drawContactPoint(pointOnB: any, normalOnB: any, distance: any, _lifeTime: any, color: any) {\n    // @ts-ignore\n    const heap = Ammo.HEAPF32\n    const r = heap[(color + 0) / 4]\n    const g = heap[(color + 4) / 4]\n    const b = heap[(color + 8) / 4]\n\n    const x = heap[(pointOnB + 0) / 4]\n    const y = heap[(pointOnB + 4) / 4]\n    const z = heap[(pointOnB + 8) / 4]\n    this.geometry.attributes.position.setXYZ(this.index, x, y, z)\n    this.geometry.attributes.color.setXYZ(this.index++, r, g, b)\n\n    const dx = heap[(normalOnB + 0) / 4] * distance\n    const dy = heap[(normalOnB + 4) / 4] * distance\n    const dz = heap[(normalOnB + 8) / 4] * distance\n    this.geometry.attributes.position.setXYZ(this.index, x + dx, y + dy, z + dz)\n    this.geometry.attributes.color.setXYZ(this.index++, r, g, b)\n  }\n\n  reportErrorWarning(warningString: string) {\n    if (Ammo.hasOwnProperty('Pointer_stringify')) {\n      // @ts-ignore\n      console.warn(Ammo.Pointer_stringify(warningString))\n    } else if (!this.warnedOnce) {\n      this.warnedOnce = true\n      console.warn(\"Cannot print warningString, please rebuild Ammo.js using 'debug' flag\")\n    }\n  }\n\n  draw3dText(_location: any, _textString: any) {\n    //TODO\n    console.warn('TODO: draw3dText')\n  }\n\n  setDebugMode(debugMode: any) {\n    this.debugDrawMode = debugMode\n  }\n\n  getDebugMode() {\n    return this.debugDrawMode\n  }\n}\n\nexport default DebugDrawer\n","/**\n * @author       Yannick Deubel (https://github.com/yandeu)\n * @copyright    Copyright (c) 2020 Yannick Deubel; Project Url: https://github.com/enable3d/enable3d\n * @license      {@link https://github.com/enable3d/enable3d/blob/master/LICENSE|GNU GPLv3}\n */\n\nimport DebugDrawer from './debugDrawer'\nimport EventEmitter from 'eventemitter3'\nimport { ExtendedObject3D, Phaser3DConfig } from '@enable3d/common/dist/types'\nimport { Vector3, Scene, Quaternion, Euler } from '@enable3d/three-wrapper/dist/index'\nimport { ConvexObjectBreaker } from './convexObjectBreaker'\nimport DefaultMaterial from '@enable3d/common/dist/defaultMaterial'\nimport PhysicsBody from './physicsBody'\n\nclass Physics extends EventEmitter {\n  public tmpTrans: Ammo.btTransform\n  public physicsWorld: Ammo.btDiscreteDynamicsWorld\n  protected dispatcher: Ammo.btCollisionDispatcher\n  protected rigidBodies: ExtendedObject3D[] = []\n  protected objectsAmmo: { [ptr: number]: any } = {}\n  protected earlierDetectedCollisions: { combinedName: string; collision: boolean }[] = []\n  protected debugDrawer: DebugDrawer\n  private convexBreaker: any\n  protected addRigidBody: (threeObject: ExtendedObject3D, physicsShape: any, mass: any, pos: any, quat: any) => void\n  private objectsToRemove: any[]\n  private numObjectsToRemove: number\n  protected gravity: { x: number; y: number; z: number }\n\n  protected emptyV3: Vector3\n  protected impactPoint: Vector3\n  protected impactNormal: Vector3\n\n  protected tmpEuler: Euler\n  protected tmpQuaternion: Quaternion\n  protected tmpVector3: Vector3\n  protected tmpBtVector3: Ammo.btVector3\n  protected tmpBtQuaternion: Ammo.btQuaternion\n\n  protected defaultMaterial: DefaultMaterial\n\n  constructor(protected scene: Scene | 'headless', public config: Phaser3DConfig = {}) {\n    super()\n  }\n\n  /** Destroys a physics body. */\n  public destroy(body: PhysicsBody) {\n    if (typeof body?.ammo === 'undefined') return\n\n    const ptr = Object.values(body.ammo)[0]\n    const name = Object.values(body.ammo)[1]\n    const obj = this.objectsAmmo[ptr]\n\n    // TODO: Remember why I track objectsAmmo and rigidBodies?\n    // console.log(this.objectsAmmo)\n    // console.log(this.rigidBodies)\n\n    if (ptr && name && obj) {\n      if (obj?.body?.ammo) {\n        // remove from physics world\n        this.physicsWorld.removeRigidBody(obj.body.ammo)\n\n        // reset properties\n        obj.body = undefined\n        obj.hasBody = false\n\n        // remove from this.objectAmmo\n        delete this.objectsAmmo[ptr]\n        // remove from this.rigidBodies\n        for (var i = 0; i < this.rigidBodies.length; i++) {\n          if (this.rigidBodies[i].name === name) {\n            this.rigidBodies.splice(i, 1)\n            i--\n          }\n        }\n      }\n    }\n  }\n\n  protected setup() {\n    if (this.scene !== 'headless') {\n      // Initialize convexBreaker\n      // @ts-ignore\n      this.convexBreaker = new ConvexObjectBreaker()\n\n      this.objectsToRemove = []\n      this.numObjectsToRemove = 0\n      for (var i = 0; i < 500; i++) {\n        this.objectsToRemove[i] = null\n      }\n    }\n\n    // setup ammo physics\n    this.setupPhysicsWorld()\n\n    if (this.scene !== 'headless') this.debugDrawer = new DebugDrawer(this.scene, this.physicsWorld, {})\n\n    /**\n     * TODO add ghost object\n     */\n    // const ghost = new Ammo.btGhostObject()\n    // ghost.setCollisionShape(new Ammo.btSphereShape(10))\n    // ghost.setWorldTransform(new Ammo.btTransform(new Ammo.btQuaternion(0, 0, 0, 1), new Ammo.btVector3(0, 15, 0)))\n    // ghost.setCollisionFlags(4)\n    // this.physicsWorld.addCollisionObject(ghost)\n\n    // run the phaser update method\n    /*if (!this.phaser3D.isXrEnabled)\n      this.scene.events.on('update', (_time: number, delta: number) => {\n        this.update(delta)\n        this.updateDebugger()\n      })*/\n  }\n\n  public updateDebugger() {\n    if (this.scene === 'headless') return\n\n    if (this.debugDrawer && this.debugDrawer.enabled) this.debugDrawer.update()\n  }\n\n  protected setupPhysicsWorld() {\n    const g = this.gravity\n\n    const collisionConfiguration = new Ammo.btDefaultCollisionConfiguration()\n    const dispatcher = new Ammo.btCollisionDispatcher(collisionConfiguration)\n    const broadphase = new Ammo.btDbvtBroadphase()\n    const solver = new Ammo.btSequentialImpulseConstraintSolver()\n    this.physicsWorld = new Ammo.btDiscreteDynamicsWorld(dispatcher, broadphase, solver, collisionConfiguration)\n    this.physicsWorld.setGravity(new Ammo.btVector3(g.x, g.y, g.z))\n\n    this.dispatcher = dispatcher\n    this.tmpTrans = new Ammo.btTransform()\n  }\n\n  private createDebrisFromBreakableObject(object: ExtendedObject3D, parent: ExtendedObject3D) {\n    if (this.scene === 'headless') return\n\n    object.material = this.defaultMaterial.get()\n    object.shape = 'hull'\n    object.fragmentDepth = parent.fragmentDepth + 1\n\n    // Add the object to the scene\n    this.scene.add(object)\n\n    // Add physics to the object\n    // @ts-ignore\n    this.addExisting(object)\n\n    object.body.breakable = false\n    // make this fragment breakable in 2.5seconds\n    setTimeout(() => {\n      object.body.breakable = true\n    }, 2500)\n  }\n\n  private removeDebris(object: any) {\n    if (this.scene === 'headless') return\n\n    this.scene.remove(object)\n    this.physicsWorld.removeRigidBody(object.body.ammo)\n    delete this.objectsAmmo[object.ptr]\n  }\n\n  public update(delta: number) {\n    // reset these vectors\n    this.impactPoint.set(0, 0, 0)\n    this.impactNormal.set(0, 0, 0)\n\n    const detectedCollisions: { combinedName: string; collision: boolean }[] = []\n\n    // Step world\n    const deltaTime = delta / 1000\n    this.physicsWorld.stepSimulation(deltaTime, this.config.maxSubSteps || 1, this.config.fixedTimeStep || 1 / 60)\n\n    /**\n     * Update rigid bodies\n     */\n    if (this.scene !== 'headless') {\n      for (var i = 0, il = this.rigidBodies.length; i < il; i++) {\n        var objThree = this.rigidBodies[i]\n        var objPhys = objThree.body.ammo\n        var ms = objPhys.getMotionState()\n\n        if (ms) {\n          ms.getWorldTransform(this.tmpTrans)\n\n          // check if object did an update since last call\n          if (objThree.body.didUpdate) {\n            // @ts-ignore\n            if (objThree.body._emitUpdateEvents) objThree.body.eventEmitter.emit('update')\n            objThree.body.didUpdate = false\n          }\n\n          // update positions\n          if (objThree.body.ammo.isKinematicObject() && objThree.body.needUpdate) {\n            // get position and rotation\n            objThree.getWorldQuaternion(this.tmpQuaternion)\n            objThree.getWorldPosition(this.tmpVector3)\n            // adjust tmp variables\n            this.tmpBtVector3.setValue(this.tmpVector3.x, this.tmpVector3.y, this.tmpVector3.z)\n            this.tmpBtQuaternion.setValue(\n              this.tmpQuaternion.x,\n              this.tmpQuaternion.y,\n              this.tmpQuaternion.z,\n              this.tmpQuaternion.w\n            )\n            // set position and rotation\n            this.tmpTrans.setOrigin(this.tmpBtVector3)\n            this.tmpTrans.setRotation(this.tmpBtQuaternion)\n            // set transform\n            ms.setWorldTransform(this.tmpTrans)\n            // reset needsUpdate\n            objThree.body.needUpdate = false\n          } else {\n            // get position and rotation\n            let p = this.tmpTrans.getOrigin()\n            let q = this.tmpTrans.getRotation()\n            // body offset\n            let o = objThree.body.offset\n            // set position and rotation\n            objThree.position.set(p.x() + o.x, p.y() + o.y, p.z() + o.z)\n            objThree.quaternion.set(q.x(), q.y(), q.z(), q.w())\n          }\n\n          objThree.body.collided = false\n        }\n      }\n    }\n\n    /**\n     * Check collisions\n     */\n    for (var i = 0, il = this.dispatcher.getNumManifolds(); i < il; i++) {\n      const contactManifold = this.dispatcher.getManifoldByIndexInternal(i)\n      const key = Object.keys(contactManifold.getBody0())[0]\n\n      // @ts-ignore\n      const body0 = Ammo.castObject(contactManifold.getBody0(), Ammo.btRigidBody)\n      // @ts-ignore\n      const body1 = Ammo.castObject(contactManifold.getBody1(), Ammo.btRigidBody)\n\n      // do not check collision between 2 unnamed objects\n      // (fragments do not have a name, for example)\n      if (body0.name === '' && body1.name === '') continue\n\n      // @ts-ignore\n      const ptr0 = body0[key]\n      // @ts-ignore\n      const ptr1 = body1[key]\n      const threeObject0 = this.objectsAmmo[ptr0] as ExtendedObject3D\n      const threeObject1 = this.objectsAmmo[ptr1] as ExtendedObject3D\n\n      if (!threeObject0 || !threeObject1) {\n        continue\n      }\n\n      /**\n       * Get some information\n       */\n      const breakable0 = threeObject0.body.breakable\n      const breakable1 = threeObject1.body.breakable\n\n      const collided0 = threeObject0.body.collided\n      const collided1 = threeObject1.body.collided\n\n      const checkCollisions0 = threeObject0.body?.checkCollisions\n      const checkCollisions1 = threeObject1.body?.checkCollisions\n\n      /**\n       * Handle collision events\n       */\n      if (checkCollisions0 || checkCollisions1) {\n        // check if a collision between these object has already been processed\n        const names = [threeObject0.name, threeObject1.name].sort()\n        const combinedName = `${names[0]}__${names[1]}`\n        let event\n        if (this.earlierDetectedCollisions.find(el => el.combinedName === combinedName)) event = 'colliding'\n        else event = 'start'\n        detectedCollisions.push({ combinedName, collision: true })\n        this.emit('collision', { bodies: [threeObject0, threeObject1], event })\n      }\n\n      if ((!breakable0 && !breakable1) || (collided0 && collided1)) {\n        continue\n      }\n\n      let contact = false\n      let maxImpulse = 0\n      for (var j = 0, jl = contactManifold.getNumContacts(); j < jl; j++) {\n        var contactPoint = contactManifold.getContactPoint(j)\n\n        if (contactPoint.getDistance() < 0) {\n          contact = true\n          var impulse = contactPoint.getAppliedImpulse()\n\n          if (impulse > maxImpulse) {\n            maxImpulse = impulse\n            var pos = contactPoint.get_m_positionWorldOnB()\n            var normal = contactPoint.get_m_normalWorldOnB()\n            this.impactPoint.set(pos.x(), pos.y(), pos.z())\n            this.impactNormal.set(normal.x(), normal.y(), normal.z())\n          }\n\n          break\n        }\n      }\n\n      // If no point has contact, abort\n      if (!contact) continue\n\n      /**\n       * Check for breakable objects (subdivision)\n       */\n      const fractureImpulse = 5 //250\n      const MAX_FRAGMENT_DEPTH = 2\n\n      // since the library convexBreaker makes use of three's userData\n      // we have to clone the necessary params to threeObjectX.userData\n      // TODO improve this\n\n      this.emptyV3.set(0, 0, 0)\n      threeObject0.userData = {\n        mass: 1,\n        velocity: this.emptyV3,\n        angularVelocity: this.emptyV3,\n        breakable: breakable0,\n        physicsBody: body0\n      }\n      threeObject1.userData = {\n        mass: 1,\n        velocity: this.emptyV3,\n        angularVelocity: this.emptyV3,\n        breakable: breakable1,\n        physicsBody: body1\n      }\n      if (typeof threeObject0.fragmentDepth === 'undefined') threeObject0.fragmentDepth = 0\n      if (typeof threeObject1.fragmentDepth === 'undefined') threeObject1.fragmentDepth = 0\n\n      // threeObject0\n      if (breakable0 && !collided0 && maxImpulse > fractureImpulse && threeObject0.fragmentDepth < MAX_FRAGMENT_DEPTH) {\n        var debris = this.convexBreaker.subdivideByImpact(threeObject0, this.impactPoint, this.impactNormal, 1, 2) //, 1.5)\n\n        var numObjects = debris.length\n        for (var j = 0; j < numObjects; j++) {\n          var vel = body0.getLinearVelocity()\n          var angVel = body0.getAngularVelocity()\n          var fragment = debris[j] as ExtendedObject3D\n          fragment.userData.velocity.set(vel.x(), vel.y(), vel.z())\n          fragment.userData.angularVelocity.set(angVel.x(), angVel.y(), angVel.z())\n\n          this.createDebrisFromBreakableObject(fragment, threeObject0)\n        }\n\n        this.objectsToRemove[this.numObjectsToRemove++] = threeObject0\n        threeObject0.body.collided = true\n      }\n\n      // threeObject1\n      if (breakable1 && !collided1 && maxImpulse > fractureImpulse && threeObject1.fragmentDepth < MAX_FRAGMENT_DEPTH) {\n        var debris = this.convexBreaker.subdivideByImpact(threeObject1, this.impactPoint, this.impactNormal, 1, 2) //, 1.5)\n\n        var numObjects = debris.length\n        for (var j = 0; j < numObjects; j++) {\n          var vel = body1.getLinearVelocity()\n          var angVel = body1.getAngularVelocity()\n          var fragment = debris[j] as ExtendedObject3D\n          fragment.userData.velocity.set(vel.x(), vel.y(), vel.z())\n          fragment.userData.angularVelocity.set(angVel.x(), angVel.y(), angVel.z())\n\n          this.createDebrisFromBreakableObject(fragment, threeObject1)\n        }\n\n        this.objectsToRemove[this.numObjectsToRemove++] = threeObject1\n        threeObject1.body.collided = true\n      }\n    }\n\n    /**\n     * Remove objects\n     */\n    for (var i = 0; i < this.numObjectsToRemove; i++) {\n      this.removeDebris(this.objectsToRemove[i])\n    }\n    this.numObjectsToRemove = 0\n\n    /**\n     * Handle collision end events\n     */\n    this.earlierDetectedCollisions.forEach(el => {\n      const { combinedName } = el\n      if (!detectedCollisions.find(el => el.combinedName === combinedName)) {\n        const split = combinedName.split('__')\n        const obj0 = this.rigidBodies.find(obj => obj.name === split[0])\n        const obj1 = this.rigidBodies.find(obj => obj.name === split[1])\n        if (obj0 && obj1) this.emit('collision', { bodies: [obj0, obj1], event: 'end' })\n      }\n    })\n    this.earlierDetectedCollisions = [...detectedCollisions]\n  }\n}\n\nexport default Physics\n","/**\n * @author       Yannick Deubel (https://github.com/yandeu)\n * @copyright    Copyright (c) 2020 Yannick Deubel; Project Url: https://github.com/enable3d/enable3d\n * @description  This is a modified version of the original code from Kevin Lee\n */\n\n/**\n * @author       Kevin Lee (https://github.com/InfiniteLee)\n * @copyright    Copyright (c) 2019 Kevin Lee; Project Url: https://github.com/InfiniteLee/three-to-ammo\n * @license      {@link https://github.com/InfiniteLee/three-to-ammo/blob/master/LICENSE|MPL-2.0}\n */\n\n'use strict'\n/* global Ammo */\n\nconst TYPE = {\n  BOX: 'box',\n  CYLINDER: 'cylinder',\n  SPHERE: 'sphere',\n  CAPSULE: 'capsule',\n  CONE: 'cone',\n  HULL: 'hull',\n  HACD: 'hacd', //Hierarchical Approximate Convex Decomposition\n  VHACD: 'vhacd', //Volumetric Hierarchical Approximate Convex Decomposition\n  MESH: 'mesh',\n  HEIGHTFIELD: 'heightfield'\n}\n\nconst FIT = {\n  ALL: 'all', //A single shape is automatically sized to bound all meshes within the entity.\n  MANUAL: 'manual' //A single shape is sized manually. Requires halfExtents or sphereRadius.\n}\n\nconst HEIGHTFIELD_DATA_TYPE = {\n  short: 'short',\n  float: 'float'\n}\n\nimport ExtendedObject3d from '@enable3d/common/dist/extendedObject3D'\nimport { Vector3, Matrix4, BufferGeometry, Quaternion, Box3 } from '@enable3d/three-wrapper/dist/index'\nimport logger from '@enable3d/common/dist/logger'\n\nconst hasUpdateMatricesFunction = ExtendedObject3d.prototype.hasOwnProperty('updateMatrices')\n\nexport const createCollisionShapes = function (root, options) {\n  switch (options.type) {\n    case TYPE.BOX:\n      return createBoxShape(root, options)\n    case TYPE.CYLINDER:\n      return createCylinderShape(root, options)\n    case TYPE.CAPSULE:\n      return createCapsuleShape(root, options)\n    case TYPE.CONE:\n      return createConeShape(root, options)\n    case TYPE.SPHERE:\n      return createSphereShape(root, options)\n    case TYPE.HULL:\n      return createHullShape(root, options)\n    case TYPE.HACD:\n      return createHACDShapes(root, options)\n    case TYPE.VHACD:\n      return createVHACDShapes(root, options)\n    case TYPE.MESH:\n      return createTriMeshShape(root, options)\n    case TYPE.HEIGHTFIELD:\n      return createHeightfieldTerrainShape(root, options)\n    default:\n      logger(options.type + ' is not currently supported')\n      return []\n  }\n}\n\n//TODO: support gimpact (dynamic trimesh) and heightmap\n\nexport const createBoxShape = function (root, options) {\n  options.type = TYPE.BOX\n  _setOptions(options)\n\n  if (options.fit === FIT.ALL) {\n    options.halfExtents = _computeHalfExtents(\n      root,\n      _computeBounds(root, options),\n      options.minHalfExtent,\n      options.maxHalfExtent\n    )\n  }\n\n  const btHalfExtents = new Ammo.btVector3(options.halfExtents.x, options.halfExtents.y, options.halfExtents.z)\n  const collisionShape = new Ammo.btBoxShape(btHalfExtents)\n  Ammo.destroy(btHalfExtents)\n\n  _finishCollisionShape(collisionShape, options, _computeScale(root, options))\n  return collisionShape\n}\n\nexport const createCylinderShape = function (root, options) {\n  options.type = TYPE.CYLINDER\n  _setOptions(options)\n\n  if (options.fit === FIT.ALL) {\n    options.halfExtents = _computeHalfExtents(\n      root,\n      _computeBounds(root, options),\n      options.minHalfExtent,\n      options.maxHalfExtent\n    )\n  }\n\n  const btHalfExtents = new Ammo.btVector3(options.halfExtents.x, options.halfExtents.y, options.halfExtents.z)\n  const collisionShape = (() => {\n    switch (options.cylinderAxis) {\n      case 'y':\n        return new Ammo.btCylinderShape(btHalfExtents)\n      case 'x':\n        return new Ammo.btCylinderShapeX(btHalfExtents)\n      case 'z':\n        return new Ammo.btCylinderShapeZ(btHalfExtents)\n    }\n    return null\n  })()\n  Ammo.destroy(btHalfExtents)\n\n  _finishCollisionShape(collisionShape, options, _computeScale(root, options))\n  return collisionShape\n}\n\nexport const createCapsuleShape = function (root, options) {\n  options.type = TYPE.CAPSULE\n  _setOptions(options)\n\n  if (options.fit === FIT.ALL) {\n    options.halfExtents = _computeHalfExtents(\n      root,\n      _computeBounds(root, options),\n      options.minHalfExtent,\n      options.maxHalfExtent\n    )\n  }\n\n  const { x, y, z } = options.halfExtents\n  const collisionShape = (() => {\n    switch (options.cylinderAxis) {\n      case 'y':\n        return new Ammo.btCapsuleShape(Math.max(x, z), y * 2)\n      case 'x':\n        return new Ammo.btCapsuleShapeX(Math.max(y, z), x * 2)\n      case 'z':\n        return new Ammo.btCapsuleShapeZ(Math.max(x, y), z * 2)\n    }\n    return null\n  })()\n\n  _finishCollisionShape(collisionShape, options, _computeScale(root, options))\n  return collisionShape\n}\n\nexport const createConeShape = function (root, options) {\n  options.type = TYPE.CONE\n  _setOptions(options)\n\n  if (options.fit === FIT.ALL) {\n    options.halfExtents = _computeHalfExtents(\n      root,\n      _computeBounds(root, options),\n      options.minHalfExtent,\n      options.maxHalfExtent\n    )\n  }\n\n  const { x, y, z } = options.halfExtents\n  const collisionShape = (() => {\n    switch (options.cylinderAxis) {\n      case 'y':\n        return new Ammo.btConeShape(Math.max(x, z), y * 2)\n      case 'x':\n        return new Ammo.btConeShapeX(Math.max(y, z), x * 2)\n      case 'z':\n        return new Ammo.btConeShapeZ(Math.max(x, y), z * 2)\n    }\n    return null\n  })()\n\n  _finishCollisionShape(collisionShape, options, _computeScale(root, options))\n  return collisionShape\n}\n\nexport const createSphereShape = function (root, options) {\n  options.type = TYPE.SPHERE\n  _setOptions(options)\n\n  let radius\n  if (options.fit === FIT.MANUAL && !isNaN(options.sphereRadius)) {\n    radius = options.sphereRadius\n  } else {\n    radius = _computeRadius(root, options, _computeBounds(root, options))\n  }\n\n  const collisionShape = new Ammo.btSphereShape(radius)\n  _finishCollisionShape(collisionShape, options, _computeScale(root, options))\n\n  return collisionShape\n}\n\nexport const createHullShape = (function () {\n  const vertex = new Vector3()\n  const center = new Vector3()\n  return function (root, options) {\n    options.type = TYPE.HULL\n    _setOptions(options)\n\n    if (options.fit === FIT.MANUAL) {\n      console.warn('cannot use fit: manual with type: hull')\n      return null\n    }\n\n    const bounds = _computeBounds(root, options)\n\n    const btVertex = new Ammo.btVector3()\n    const originalHull = new Ammo.btConvexHullShape()\n    originalHull.setMargin(options.margin)\n    center.addVectors(bounds.max, bounds.min).multiplyScalar(0.5)\n\n    let vertexCount = 0\n    _iterateGeometries(root, options, geo => {\n      vertexCount += geo.attributes.position.array.length / 3\n    })\n\n    const maxVertices = options.hullMaxVertices || 100000\n    // todo: might want to implement this in a deterministic way that doesn't do O(verts) calls to Math.random\n    if (vertexCount > maxVertices) {\n      console.warn(`too many vertices for hull shape; sampling ~${maxVertices} from ~${vertexCount} vertices`)\n    }\n    const p = Math.min(1, maxVertices / vertexCount)\n\n    _iterateGeometries(root, options, (geo, transform) => {\n      adjustGeometryTranslateEXPERIMENTAL(geo, transform)\n\n      const components = geo.attributes.position.array\n      for (let i = 0; i < components.length; i += 3) {\n        if (Math.random() <= p) {\n          vertex\n            .set(components[i], components[i + 1], components[i + 2])\n            .applyMatrix4(transform)\n            .sub(center)\n          btVertex.setValue(vertex.x, vertex.y, vertex.z)\n          originalHull.addPoint(btVertex, i === components.length - 3) // todo: better to recalc AABB only on last geometry\n        }\n      }\n    })\n\n    let collisionShape = originalHull\n    if (originalHull.getNumVertices() >= 100) {\n      //Bullet documentation says don't use convexHulls with 100 verts or more\n      const shapeHull = new Ammo.btShapeHull(originalHull)\n      shapeHull.buildHull(options.margin)\n      Ammo.destroy(originalHull)\n      collisionShape = new Ammo.btConvexHullShape(\n        Ammo.getPointer(shapeHull.getVertexPointer()),\n        shapeHull.numVertices()\n      )\n      Ammo.destroy(shapeHull) // btConvexHullShape makes a copy\n    }\n\n    Ammo.destroy(btVertex)\n\n    _finishCollisionShape(collisionShape, options, _computeScale(root, options))\n    return collisionShape\n  }\n})()\n\nexport const createHACDShapes = (function () {\n  const v = new Vector3()\n  const center = new Vector3()\n  return function (root, options) {\n    options.type = TYPE.HACD\n    _setOptions(options)\n\n    if (options.fit === FIT.MANUAL) {\n      console.warn('cannot use fit: manual with type: hacd')\n      return []\n    }\n\n    if (!Ammo.hasOwnProperty('HACD')) {\n      console.warn(\n        'HACD unavailable in included build of Ammo.js. Visit https://github.com/mozillareality/ammo.js for the latest version.'\n      )\n      return []\n    }\n\n    const bounds = _computeBounds(root)\n    const scale = _computeScale(root, options)\n\n    let vertexCount = 0\n    let triCount = 0\n    center.addVectors(bounds.max, bounds.min).multiplyScalar(0.5)\n\n    _iterateGeometries(root, options, geo => {\n      vertexCount += geo.attributes.position.array.length / 3\n      if (geo.index) {\n        triCount += geo.index.array.length / 3\n      } else {\n        triCount += geo.attributes.position.array.length / 9\n      }\n    })\n\n    const hacd = new Ammo.HACD()\n    if (options.hasOwnProperty('compacityWeight')) hacd.SetCompacityWeight(options.compacityWeight)\n    if (options.hasOwnProperty('volumeWeight')) hacd.SetVolumeWeight(options.volumeWeight)\n    if (options.hasOwnProperty('nClusters')) hacd.SetNClusters(options.nClusters)\n    if (options.hasOwnProperty('nVerticesPerCH')) hacd.SetNVerticesPerCH(options.nVerticesPerCH)\n    if (options.hasOwnProperty('concavity')) hacd.SetConcavity(options.concavity)\n\n    const points = Ammo._malloc(vertexCount * 3 * 8)\n    const triangles = Ammo._malloc(triCount * 3 * 4)\n    hacd.SetPoints(points)\n    hacd.SetTriangles(triangles)\n    hacd.SetNPoints(vertexCount)\n    hacd.SetNTriangles(triCount)\n\n    const pptr = points / 8,\n      tptr = triangles / 4\n    _iterateGeometries(root, options, (geo, transform) => {\n      adjustGeometryTranslateEXPERIMENTAL(geo, transform)\n\n      const components = geo.attributes.position.array\n      const indices = geo.index ? geo.index.array : null\n      for (let i = 0; i < components.length; i += 3) {\n        v.set(components[i + 0], components[i + 1], components[i + 2])\n          .applyMatrix4(transform)\n          .sub(center)\n        Ammo.HEAPF64[pptr + i + 0] = v.x\n        Ammo.HEAPF64[pptr + i + 1] = v.y\n        Ammo.HEAPF64[pptr + i + 2] = v.z\n      }\n      if (indices) {\n        for (let i = 0; i < indices.length; i++) {\n          Ammo.HEAP32[tptr + i] = indices[i]\n        }\n      } else {\n        for (let i = 0; i < components.length / 3; i++) {\n          Ammo.HEAP32[tptr + i] = i\n        }\n      }\n    })\n\n    hacd.Compute()\n    Ammo._free(points)\n    Ammo._free(triangles)\n    const nClusters = hacd.GetNClusters()\n\n    const shapes = []\n    for (let i = 0; i < nClusters; i++) {\n      const hull = new Ammo.btConvexHullShape()\n      hull.setMargin(options.margin)\n      const nPoints = hacd.GetNPointsCH(i)\n      const nTriangles = hacd.GetNTrianglesCH(i)\n      const hullPoints = Ammo._malloc(nPoints * 3 * 8)\n      const hullTriangles = Ammo._malloc(nTriangles * 3 * 4)\n      hacd.GetCH(i, hullPoints, hullTriangles)\n\n      const pptr = hullPoints / 8\n      for (let pi = 0; pi < nPoints; pi++) {\n        const btVertex = new Ammo.btVector3()\n        const px = Ammo.HEAPF64[pptr + pi * 3 + 0]\n        const py = Ammo.HEAPF64[pptr + pi * 3 + 1]\n        const pz = Ammo.HEAPF64[pptr + pi * 3 + 2]\n        btVertex.setValue(px, py, pz)\n        hull.addPoint(btVertex, pi === nPoints - 1)\n        Ammo.destroy(btVertex)\n      }\n\n      _finishCollisionShape(hull, options, scale)\n      shapes.push(hull)\n    }\n\n    return shapes\n  }\n})()\n\nexport const createVHACDShapes = (function () {\n  const v = new Vector3()\n  const center = new Vector3()\n  return function (root, options) {\n    options.type = TYPE.VHACD\n    _setOptions(options)\n\n    if (options.fit === FIT.MANUAL) {\n      console.warn('cannot use fit: manual with type: vhacd')\n      return []\n    }\n\n    if (!Ammo.hasOwnProperty('VHACD')) {\n      console.warn(\n        'VHACD unavailable in included build of Ammo.js. Visit https://github.com/mozillareality/ammo.js for the latest version.'\n      )\n      return []\n    }\n\n    const bounds = _computeBounds(root, options)\n    const scale = _computeScale(root, options)\n\n    let vertexCount = 0\n    let triCount = 0\n    center.addVectors(bounds.max, bounds.min).multiplyScalar(0.5)\n\n    _iterateGeometries(root, options, geo => {\n      vertexCount += geo.attributes.position.count\n      if (geo.index) {\n        triCount += geo.index.count / 3\n      } else {\n        triCount += geo.attributes.position.count / 3\n      }\n    })\n\n    const vhacd = new Ammo.VHACD()\n    const params = new Ammo.Parameters()\n    //https://kmamou.blogspot.com/2014/12/v-hacd-20-parameters-description.html\n    if (options.hasOwnProperty('resolution')) params.set_m_resolution(options.resolution)\n    if (options.hasOwnProperty('depth')) params.set_m_depth(options.depth)\n    if (options.hasOwnProperty('concavity')) params.set_m_concavity(options.concavity)\n    if (options.hasOwnProperty('planeDownsampling')) params.set_m_planeDownsampling(options.planeDownsampling)\n    if (options.hasOwnProperty('convexhullDownsampling'))\n      params.set_m_convexhullDownsampling(options.convexhullDownsampling)\n    if (options.hasOwnProperty('alpha')) params.set_m_alpha(options.alpha)\n    if (options.hasOwnProperty('beta')) params.set_m_beta(options.beta)\n    if (options.hasOwnProperty('gamma')) params.set_m_gamma(options.gamma)\n    if (options.hasOwnProperty('pca')) params.set_m_pca(options.pca)\n    if (options.hasOwnProperty('mode')) params.set_m_mode(options.mode)\n    if (options.hasOwnProperty('maxNumVerticesPerCH')) params.set_m_maxNumVerticesPerCH(options.maxNumVerticesPerCH)\n    if (options.hasOwnProperty('minVolumePerCH')) params.set_m_minVolumePerCH(options.minVolumePerCH)\n    if (options.hasOwnProperty('convexhullApproximation'))\n      params.set_m_convexhullApproximation(options.convexhullApproximation)\n    if (options.hasOwnProperty('oclAcceleration')) params.set_m_oclAcceleration(options.oclAcceleration)\n\n    const points = Ammo._malloc(vertexCount * 3 * 8)\n    const triangles = Ammo._malloc(triCount * 3 * 4)\n\n    let pptr = points / 8,\n      tptr = triangles / 4\n    _iterateGeometries(root, options, (geo, transform) => {\n      adjustGeometryTranslateEXPERIMENTAL(geo, transform)\n\n      const components = geo.attributes.position.array\n      const indices = geo.index ? geo.index.array : null\n      for (let i = 0; i < components.length; i += 3) {\n        v.set(components[i + 0], components[i + 1], components[i + 2])\n          .applyMatrix4(transform)\n          .sub(center)\n        Ammo.HEAPF64[pptr + 0] = v.x\n        Ammo.HEAPF64[pptr + 1] = v.y\n        Ammo.HEAPF64[pptr + 2] = v.z\n        pptr += 3\n      }\n      if (indices) {\n        for (let i = 0; i < indices.length; i++) {\n          Ammo.HEAP32[tptr] = indices[i]\n          tptr++\n        }\n      } else {\n        for (let i = 0; i < components.length / 3; i++) {\n          Ammo.HEAP32[tptr] = i\n          tptr++\n        }\n      }\n    })\n\n    vhacd.Compute(points, 3, vertexCount, triangles, 3, triCount, params)\n    Ammo._free(points)\n    Ammo._free(triangles)\n    const nHulls = vhacd.GetNConvexHulls()\n\n    const shapes = []\n    const ch = new Ammo.ConvexHull()\n    for (let i = 0; i < nHulls; i++) {\n      vhacd.GetConvexHull(i, ch)\n      const nPoints = ch.get_m_nPoints()\n      const hullPoints = ch.get_m_points()\n\n      const hull = new Ammo.btConvexHullShape()\n      hull.setMargin(options.margin)\n\n      for (let pi = 0; pi < nPoints; pi++) {\n        const btVertex = new Ammo.btVector3()\n        const px = ch.get_m_points(pi * 3 + 0)\n        const py = ch.get_m_points(pi * 3 + 1)\n        const pz = ch.get_m_points(pi * 3 + 2)\n        btVertex.setValue(px, py, pz)\n        hull.addPoint(btVertex, pi === nPoints - 1)\n        Ammo.destroy(btVertex)\n      }\n\n      _finishCollisionShape(hull, options, scale)\n      shapes.push(hull)\n    }\n    Ammo.destroy(ch)\n    Ammo.destroy(vhacd)\n\n    return shapes\n  }\n})()\n\nexport const createTriMeshShape = (function () {\n  const va = new Vector3()\n  const vb = new Vector3()\n  const vc = new Vector3()\n  return function (root, options) {\n    options.type = TYPE.MESH\n    _setOptions(options)\n\n    if (options.fit === FIT.MANUAL) {\n      console.warn('cannot use fit: manual with type: mesh')\n      return null\n    }\n\n    const scale = _computeScale(root, options)\n\n    const bta = new Ammo.btVector3()\n    const btb = new Ammo.btVector3()\n    const btc = new Ammo.btVector3()\n    const triMesh = new Ammo.btTriangleMesh(true, false)\n\n    _iterateGeometries(root, options, (geo, transform) => {\n      const components = geo.attributes.position.array\n      if (geo.index) {\n        for (let i = 0; i < geo.index.count; i += 3) {\n          const ai = geo.index.array[i] * 3\n          const bi = geo.index.array[i + 1] * 3\n          const ci = geo.index.array[i + 2] * 3\n          va.set(components[ai], components[ai + 1], components[ai + 2]).applyMatrix4(transform)\n          vb.set(components[bi], components[bi + 1], components[bi + 2]).applyMatrix4(transform)\n          vc.set(components[ci], components[ci + 1], components[ci + 2]).applyMatrix4(transform)\n          bta.setValue(va.x, va.y, va.z)\n          btb.setValue(vb.x, vb.y, vb.z)\n          btc.setValue(vc.x, vc.y, vc.z)\n          triMesh.addTriangle(bta, btb, btc, false)\n        }\n      } else {\n        for (let i = 0; i < components.length; i += 9) {\n          va.set(components[i + 0], components[i + 1], components[i + 2]).applyMatrix4(transform)\n          vb.set(components[i + 3], components[i + 4], components[i + 5]).applyMatrix4(transform)\n          vc.set(components[i + 6], components[i + 7], components[i + 8]).applyMatrix4(transform)\n          bta.setValue(va.x, va.y, va.z)\n          btb.setValue(vb.x, vb.y, vb.z)\n          btc.setValue(vc.x, vc.y, vc.z)\n          triMesh.addTriangle(bta, btb, btc, false)\n        }\n      }\n    })\n\n    let collisionShape\n    if (options.concave) collisionShape = new Ammo.btBvhTriangleMeshShape(triMesh, true, true)\n    else collisionShape = new Ammo.btConvexTriangleMeshShape(triMesh, true)\n\n    collisionShape.resources = [triMesh]\n\n    Ammo.destroy(bta)\n    Ammo.destroy(btb)\n    Ammo.destroy(btc)\n\n    _finishCollisionShape(collisionShape, options, scale)\n    return collisionShape\n  }\n})()\n\nexport const createHeightfieldTerrainShape = function (root, options) {\n  _setOptions(options)\n\n  if (options.fit === FIT.ALL) {\n    console.warn('cannot use fit: all with type: heightfield')\n    return null\n  }\n  const heightfieldDistance = options.heightfieldDistance || 1\n  const heightfieldData = options.heightfieldData || []\n  const heightScale = options.heightScale || 0\n  const upAxis = options.hasOwnProperty('upAxis') ? options.upAxis : 1 // x = 0; y = 1; z = 2\n  const hdt = (() => {\n    switch (options.heightDataType) {\n      case 'short':\n        return Ammo.PHY_SHORT\n      case 'float':\n        return Ammo.PHY_FLOAT\n      default:\n        return Ammo.PHY_FLOAT\n    }\n  })()\n  const flipQuadEdges = options.hasOwnProperty('flipQuadEdges') ? options.flipQuadEdges : true\n\n  const heightStickLength = heightfieldData.length\n  const heightStickWidth = heightStickLength > 0 ? heightfieldData[0].length : 0\n\n  const data = Ammo._malloc(heightStickLength * heightStickWidth * 4)\n  const ptr = data / 4\n\n  let minHeight = Number.POSITIVE_INFINITY\n  let maxHeight = Number.NEGATIVE_INFINITY\n  let index = 0\n  for (let l = 0; l < heightStickLength; l++) {\n    for (let w = 0; w < heightStickWidth; w++) {\n      const height = heightfieldData[l][w]\n      Ammo.HEAPF32[ptr + index] = height\n      index++\n      minHeight = Math.min(minHeight, height)\n      maxHeight = Math.max(maxHeight, height)\n    }\n  }\n\n  const collisionShape = new Ammo.btHeightfieldTerrainShape(\n    heightStickWidth,\n    heightStickLength,\n    data,\n    heightScale,\n    minHeight,\n    maxHeight,\n    upAxis,\n    hdt,\n    flipQuadEdges\n  )\n\n  const scale = new Ammo.btVector3(heightfieldDistance, 1, heightfieldDistance)\n  collisionShape.setLocalScaling(scale)\n  Ammo.destroy(scale)\n\n  collisionShape.heightfieldData = data\n\n  _finishCollisionShape(collisionShape, options)\n  return collisionShape\n}\n\nfunction _setOptions(options) {\n  options.fit = options.hasOwnProperty('fit') ? options.fit : FIT.ALL\n  options.type = options.type || TYPE.HULL\n  options.minHalfExtent = options.hasOwnProperty('minHalfExtent') ? options.minHalfExtent : 0\n  options.maxHalfExtent = options.hasOwnProperty('maxHalfExtent') ? options.maxHalfExtent : Number.POSITIVE_INFINITY\n  options.cylinderAxis = options.cylinderAxis || 'y'\n  options.margin = options.hasOwnProperty('margin') ? options.margin : 0.05\n  options.includeInvisible = options.hasOwnProperty('includeInvisible') ? options.includeInvisible : false\n\n  if (!options.offset) {\n    options.offset = new Vector3()\n  }\n\n  if (!options.orientation) {\n    options.orientation = new Quaternion()\n  }\n}\n\nconst _finishCollisionShape = function (collisionShape, options, scale) {\n  collisionShape.type = options.type\n  collisionShape.setMargin(options.margin)\n  collisionShape.destroy = () => {\n    for (let res of collisionShape.resources || []) {\n      Ammo.destroy(res)\n    }\n    if (collisionShape.heightfieldData) {\n      Ammo._free(collisionShape.heightfieldData)\n    }\n    Ammo.destroy(collisionShape)\n  }\n\n  // const localTransform = new Ammo.btTransform()\n  // const rotation = new Ammo.btQuaternion()\n  // localTransform.setIdentity()\n\n  // localTransform.getOrigin().setValue(options.offset.x, options.offset.y, options.offset.z)\n  // rotation.setValue(options.orientation.x, options.orientation.y, options.orientation.z, options.orientation.w)\n\n  // localTransform.setRotation(rotation)\n  // Ammo.destroy(rotation)\n\n  if (scale) {\n    const localScale = new Ammo.btVector3(scale.x, scale.y, scale.z)\n    collisionShape.setLocalScaling(localScale)\n    Ammo.destroy(localScale)\n  }\n\n  // collisionShape.localTransform = localTransform\n}\n\n// Calls `cb(geo, transform)` for each geometry under `root` whose vertices we should take into account for the physics shape.\n// `transform` is the transform required to transform the given geometry's vertices into root-local space.\nconst _iterateGeometries = (function () {\n  const transform = new Matrix4()\n  const inverse = new Matrix4()\n  const bufferGeometry = new BufferGeometry()\n  return function (root, options, cb) {\n    inverse.getInverse(root.matrixWorld)\n    root.traverse(mesh => {\n      if (\n        mesh.isMesh /*&&\n        (!Sky || mesh.__proto__ != Sky.prototype) &&\n        (options.includeInvisible || (mesh.el && mesh.el.object3D.visible) || mesh.visible)*/\n      ) {\n        if (mesh === root) {\n          transform.identity()\n        } else {\n          if (hasUpdateMatricesFunction) mesh.updateMatrices()\n          transform.multiplyMatrices(inverse, mesh.matrixWorld)\n        }\n        // todo: might want to return null xform if this is the root so that callers can avoid multiplying\n        // things by the identity matrix\n        cb(mesh.geometry.isBufferGeometry ? mesh.geometry : bufferGeometry.fromGeometry(mesh.geometry), transform)\n      }\n    })\n  }\n})()\n\nconst _computeScale = function (root, options) {\n  // const scale = new Vector3(1, 1, 1)\n  // if (options.fit === FIT.ALL) {\n  //   scale.setFromMatrixScale(root.matrixWorld)\n  // }\n  // return scale\n  const { scale } = root\n  return scale\n}\n\nconst _computeRadius = (function () {\n  const v = new Vector3()\n  const center = new Vector3()\n  return function (root, options, bounds) {\n    let maxRadiusSq = 0\n    let { x: cx, y: cy, z: cz } = bounds.getCenter(center)\n    _iterateGeometries(root, options, (geo, transform) => {\n      const components = geo.attributes.position.array\n      for (let i = 0; i < components.length; i += 3) {\n        v.set(components[i], components[i + 1], components[i + 2]).applyMatrix4(transform)\n        const dx = cx - v.x\n        const dy = cy - v.y\n        const dz = cz - v.z\n        maxRadiusSq = Math.max(maxRadiusSq, dx * dx + dy * dy + dz * dz)\n      }\n    })\n    return Math.sqrt(maxRadiusSq)\n  }\n})()\n\nconst _computeHalfExtents = function (root, bounds, minHalfExtent, maxHalfExtent) {\n  const halfExtents = new Vector3()\n  return halfExtents.subVectors(bounds.max, bounds.min).multiplyScalar(0.5).clampScalar(minHalfExtent, maxHalfExtent)\n}\n\nconst _computeLocalOffset = function (matrix, bounds, target) {\n  target.addVectors(bounds.max, bounds.min).multiplyScalar(0.5).applyMatrix4(matrix)\n  return target\n}\n\n// returns the bounding box for the geometries underneath `root`.\nconst _computeBounds = (function () {\n  const v = new Vector3()\n  return function (root, options) {\n    const bounds = new Box3()\n    let minX = +Infinity\n    let minY = +Infinity\n    let minZ = +Infinity\n    let maxX = -Infinity\n    let maxY = -Infinity\n    let maxZ = -Infinity\n    bounds.min.set(0, 0, 0)\n    bounds.max.set(0, 0, 0)\n    _iterateGeometries(root, options, (geo, transform) => {\n      const components = geo.attributes.position.array\n      for (let i = 0; i < components.length; i += 3) {\n        v.set(components[i], components[i + 1], components[i + 2]).applyMatrix4(transform)\n        if (v.x < minX) minX = v.x\n        if (v.y < minY) minY = v.y\n        if (v.z < minZ) minZ = v.z\n        if (v.x > maxX) maxX = v.x\n        if (v.y > maxY) maxY = v.y\n        if (v.z > maxZ) maxZ = v.z\n      }\n    })\n    bounds.min.set(minX, minY, minZ)\n    bounds.max.set(maxX, maxY, maxZ)\n    return bounds\n  }\n})()\n\n// adjusts the translate of the geometry\n// https://threejs.org/docs/#api/en/core/BufferGeometry.translate\nconst adjustGeometryTranslateEXPERIMENTAL = (geo, transform) => {\n  geo.computeBoundingBox()\n  const target = new Vector3()\n  geo.boundingBox.getCenter(target)\n  transform.makeTranslation(target.x, target.y, target.z)\n}\n","/**\n * @author       Yannick Deubel (https://github.com/yandeu)\n * @copyright    Copyright (c) 2020 Yannick Deubel; Project Url: https://github.com/enable3d/enable3d\n * @license      {@link https://github.com/enable3d/enable3d/blob/master/LICENSE|GNU GPLv3}\n */\n\nimport { Quaternion } from '@enable3d/three-wrapper/dist/index'\n\n// https://pybullet.org/Bullet/phpBB3/viewtopic.php?t=7228\nexport const addTorusShape = (config: { radius: number; tube: number; tubularSegments: number }, quat: Quaternion) => {\n  const { radius = 1, tube = 0.4, tubularSegments = 8 } = config\n\n  const SIMD_PI = Math.PI\n  const subdivisions = tubularSegments\n  const gap = Math.sqrt(2.0 * tube * tube - 2.0 * tube * tube * Math.cos((2.0 * SIMD_PI) / subdivisions))\n\n  const btHalfExtents = new Ammo.btVector3(tube, SIMD_PI / subdivisions + 0.5 * gap, tube)\n  const cylinderShape = new Ammo.btCylinderShape(btHalfExtents)\n  cylinderShape.setMargin(0.05)\n\n  const compoundShape = new Ammo.btCompoundShape()\n\n  const forward = new Ammo.btVector3(0, 0, 1)\n  const side = new Ammo.btVector3(0, radius, 0)\n  const rotation = new Ammo.btQuaternion(quat.x, quat.y, quat.z, quat.w)\n\n  for (let x = 0; x < subdivisions; x++) {\n    const angle = (x * 2.0 * SIMD_PI) / subdivisions\n    const position = side.rotate(forward, angle)\n    const transform = new Ammo.btTransform()\n    rotation.setRotation(forward, angle + Math.PI / 2)\n    transform.setIdentity()\n    transform.setOrigin(position)\n    transform.setRotation(rotation)\n    compoundShape.addChildShape(transform, cylinderShape)\n  }\n\n  return compoundShape\n}\n","/**\n * @author yandeu\n * @description Ported to TypeScript\n */\n\n/**\n * @author alteredq / http://alteredqualia.com/\n */\n\n/**\n * This is the Clock class THREE provides.\n */\nclass Clock {\n  autoStart: boolean\n  startTime: number\n  oldTime: number\n  elapsedTime: number\n  running: boolean\n\n  constructor(autoStart = true) {\n    this.autoStart = autoStart !== undefined ? autoStart : true\n    this.startTime = 0\n    this.oldTime = 0\n    this.elapsedTime = 0\n    this.running = false\n  }\n\n  start() {\n    this.startTime = (typeof performance === 'undefined' ? Date : performance).now() // see #10732\n\n    this.oldTime = this.startTime\n    this.elapsedTime = 0\n    this.running = true\n  }\n\n  stop() {\n    this.getElapsedTime()\n    this.running = false\n    this.autoStart = false\n  }\n\n  getElapsedTime() {\n    this.getDelta()\n    return this.elapsedTime\n  }\n\n  getDelta() {\n    let diff = 0\n\n    if (this.autoStart && !this.running) {\n      this.start()\n      return 0\n    }\n\n    if (this.running) {\n      let newTime = (typeof performance === 'undefined' ? Date : performance).now()\n\n      diff = (newTime - this.oldTime) / 1000\n      this.oldTime = newTime\n\n      this.elapsedTime += diff\n    }\n\n    return diff\n  }\n}\n\nexport { Clock }\n","/**\n * @author       Yannick Deubel (https://github.com/yandeu)\n * @copyright    Copyright (c) 2020 Yannick Deubel; Project Url: https://github.com/enable3d/enable3d\n * @license      {@link https://github.com/enable3d/enable3d/blob/master/LICENSE|GNU GPLv3}\n */\n\nimport logger from '@enable3d/common/dist/logger'\nimport PhysicsBody from './physicsBody'\nimport {\n  PlaneConfig,\n  SphereConfig,\n  GroundConfig,\n  MaterialConfig,\n  BoxConfig,\n  CylinderConfig,\n  ConeConfig,\n  ExtrudeConfig,\n  Phaser3DConfig,\n  AddExistingConfig,\n  TorusConfig\n} from '@enable3d/common/dist/types'\nimport applyMixins from '@enable3d/common/dist/applyMixins'\nimport ExtendedObject3D from '@enable3d/common/dist/extendedObject3D'\nimport Shapes from './shapes'\nimport Constraints from './constraints'\nimport Events from './events'\nimport EventEmitter from 'eventemitter3'\nimport Physics from './physics'\nimport { Vector3, Quaternion, Scene, Mesh, Euler } from '@enable3d/three-wrapper/dist/index'\nimport { createCollisionShapes } from './three-to-ammo'\nimport { addTorusShape } from './torusShape'\nimport Factories from '@enable3d/common/dist/factories'\nimport { REVISION } from '@enable3d/three-wrapper/dist/index'\n\nimport { PhysicsLoader } from '@enable3d/common/dist/physicsLoader'\nimport DefaultMaterial from '@enable3d/common/dist/defaultMaterial'\nexport { PhysicsLoader }\n\nimport * as Types from '@enable3d/common/dist/types'\nexport { Types }\n\n// Export THREE.Clock\nexport { Clock } from './lib/Clock'\nexport { ServerClock } from '@enable3d/common/dist/serverClock'\n\ninterface AmmoPhysics extends Physics, Constraints, Shapes, Events {}\n\nclass AmmoPhysics extends EventEmitter {\n  public tmpTrans: Ammo.btTransform\n  public factory: Factories\n  public isHeadless: boolean\n\n  protected rigidBodies: ExtendedObject3D[] = []\n  protected objectsAmmo: { [ptr: number]: any } = {}\n  protected earlierDetectedCollisions: { combinedName: string; collision: boolean }[] = []\n  protected gravity: { x: number; y: number; z: number }\n\n  protected tmpEuler: Euler\n  protected tmpQuaternion: Quaternion\n  protected tmpVector3: Vector3\n  protected tmpBtVector3: Ammo.btVector3\n  protected tmpBtQuaternion: Ammo.btQuaternion\n\n  protected defaultMaterial: DefaultMaterial\n\n  constructor(public scene: Scene | 'headless', public config: Phaser3DConfig = {}) {\n    super()\n\n    this.isHeadless = scene === 'headless' ? true : false\n    this.tmpEuler = new Euler()\n    this.tmpQuaternion = new Quaternion()\n    this.tmpVector3 = new Vector3()\n    this.tmpBtVector3 = new Ammo.btVector3()\n    this.tmpBtQuaternion = new Ammo.btQuaternion(0, 0, 0, 1)\n\n    if (scene !== 'headless') {\n      this.defaultMaterial = new DefaultMaterial()\n\n      const version = `three.js version ${REVISION}`\n      console.log(\n        `%c %c %c %c %c ${version} %c https://threejs.org/`,\n        'background: #ff0000',\n        'background: #ffff00',\n        'background: #00ff00',\n        'background: #00ffff',\n        'color: #fff; background: #000000;',\n        'background: none'\n      )\n    }\n\n    this.factory = new Factories(scene)\n\n    this.emptyV3 = new Vector3()\n    this.impactPoint = new Vector3()\n    this.impactNormal = new Vector3()\n\n    this.gravity = config.gravity || { x: 0, y: -9.81, z: 0 }\n\n    this.start()\n  }\n\n  public get debug() {\n    if (this.isHeadless) return null\n\n    return {\n      enable: () => {\n        this.debugDrawer.enable()\n      },\n      mode: (debugMode: number = 1) => {\n        this.debugDrawer.setDebugMode(debugMode)\n      },\n      disable: () => {\n        this.debugDrawer.disable()\n      }\n    }\n  }\n\n  private start() {\n    if (typeof Ammo === 'undefined') {\n      logger('Are you sure you included ammo.js?')\n      return\n    }\n\n    if (typeof Ammo === 'function')\n      Ammo().then(() => {\n        this.setup()\n      })\n    else this.setup()\n  }\n\n  public get add() {\n    return {\n      collider: (\n        object1: ExtendedObject3D,\n        object2: ExtendedObject3D,\n        eventCallback: (event: 'start' | 'collision' | 'end') => void\n      ) => this.addCollider(object1, object2, eventCallback),\n      constraints: this.addConstraints,\n      existing: (object: ExtendedObject3D, config?: AddExistingConfig) => this.addExisting(object, config),\n      plane: (planeConfig: PlaneConfig = {}, materialConfig: MaterialConfig = {}) =>\n        this.addPlane(planeConfig, materialConfig),\n      sphere: (sphereConfig: SphereConfig = {}, materialConfig: MaterialConfig = {}) =>\n        this.addSphere(sphereConfig, materialConfig),\n      ground: (groundConfig: GroundConfig = {}, materialConfig: MaterialConfig = {}) =>\n        this.addGround(groundConfig, materialConfig),\n      box: (boxConfig: BoxConfig = {}, materialConfig: MaterialConfig = {}) => this.addBox(boxConfig, materialConfig),\n      cylinder: (cylinderConfig: CylinderConfig = {}, materialConfig: MaterialConfig = {}) =>\n        this.addCylinder(cylinderConfig, materialConfig),\n      cone: (coneConfig: ConeConfig = {}, materialConfig: MaterialConfig = {}) =>\n        this.addCone(coneConfig, materialConfig),\n      torus: (torusConfig: TorusConfig = {}, materialConfig: MaterialConfig = {}) =>\n        this.addTorus(torusConfig, materialConfig),\n      extrude: (extrudeConfig: ExtrudeConfig, materialConfig: MaterialConfig = {}) =>\n        this.addExtrude(extrudeConfig, materialConfig)\n    }\n  }\n\n  public addCompoundShape(shapes: any) {\n    const compoundShape = new Ammo.btCompoundShape()\n    shapes.forEach((obj: any, i: number) => {\n      const transform = new Ammo.btTransform()\n\n      const pos = new Vector3(obj.x || 0, obj.y || 0, obj.z || 0)\n      if (obj.tmp?.offset) {\n        const o = obj.tmp.offset\n        pos.add(new Vector3(o.x, o.y, o.z))\n      }\n      transform.setIdentity()\n      transform.setOrigin(new Ammo.btVector3(pos.x || 0, pos.y || 0, pos.z || 0))\n      // TODO add rotation\n      // transform.setRotation(new Ammo.btQuaternion(quat.x || 0, quat.y || 0, quat.z || 0, quat.w || 1))\n      compoundShape.addChildShape(transform, shapes[i])\n    })\n    return compoundShape\n  }\n\n  protected addExisting(object: ExtendedObject3D, config: AddExistingConfig = {}): any {\n    const { position: pos, quaternion: quat, hasBody } = object\n\n    const {\n      mass = 1,\n      autoCenter = false,\n      offset = undefined,\n      shapes = [],\n      breakable = false,\n      addRigidBody = true,\n      addChildren = true\n    } = config\n\n    const defaultParams = {\n      width: 1,\n      height: 1,\n      depth: 1,\n      radius: 1,\n      radiusTop: 1, // for the cylinder\n      radiusBottom: 1, // for the cylinder\n      tube: 0.4, // for the torus\n      tubularSegments: 6 // for the torus\n    }\n\n    // check if the object has children\n    const children: any[] = []\n    if (addChildren && object.children.length >= 1) {\n      object.children.forEach((child: any) => {\n        if (child.isMesh) {\n          const shape = this.addExisting(child, { addRigidBody: false })\n          shape.tmp = { offset: child.position.clone() }\n          children.push(shape)\n        }\n      })\n    }\n\n    let shape = 'box'\n    const type = object.geometry?.type || 'box'\n    // retrieve the shape from the geometry\n    if (/box/i.test(type)) shape = 'box'\n    else if (/cone/i.test(type)) shape = 'cone'\n    else if (/cylinder/i.test(type)) shape = 'cylinder'\n    else if (/extrude/i.test(type)) shape = 'extrude'\n    else if (/plane/i.test(type)) shape = 'plane'\n    else if (/sphere/i.test(type)) shape = 'sphere'\n    else if (/torus/i.test(type)) shape = 'torus'\n\n    let params = {}\n    if (config.shape) {\n      params = { ...defaultParams, ...config }\n      shape = config.shape\n    } else if (object.shape) {\n      // @ts-ignore\n      params = { ...defaultParams, ...object?.geometry?.parameters }\n      shape = object.shape\n    } else {\n      // @ts-ignore\n      params = { ...defaultParams, ...object?.geometry?.parameters }\n    }\n\n    // Add default params if undefined\n    Object.keys(params).forEach(key => {\n      // @ts-ignore\n      if (typeof params[key] === 'undefined' && defaultParams[key]) {\n        // @ts-ignore\n        params[key] = defaultParams[key]\n      }\n    })\n\n    if (hasBody) {\n      logger(`Object \"${object.name}\" already has a physical body!`)\n      return\n    }\n\n    // auto adjust the center for custom shapes\n    if (autoCenter) object.geometry.center()\n\n    // some aliases\n    if (shape === 'extrude') shape = 'hacd'\n    if (shape === 'mesh' || shape === 'convex') shape = 'convexMesh'\n    if (shape === 'concave') shape = 'concaveMesh'\n\n    let Shape: any\n\n    // combine multiple shapes to one compound shape\n    if (shapes.length > 0) {\n      const tmp: any[] = [] // stores all the raw shapes\n\n      shapes.forEach(obj => {\n        const s = this.addShape({ shape: obj.shape, params: { ...obj } })\n        // @ts-ignore\n        s.tmp = { offset: { x: obj.x || 0, y: obj.y || 0, z: obj.z || 0 } }\n        // TODO add rotation as well\n        tmp.push(s)\n      })\n\n      Shape = this.addCompoundShape(tmp)\n    } else {\n      Shape = this.addShape({ shape, shapes, params, object, quat })\n    }\n\n    if (!Shape) {\n      logger(`Could not recognize shape \"${shape}\"!`)\n      return\n    }\n\n    if (children.length >= 1) {\n      Shape = this.addCompoundShape([Shape, ...children])\n    }\n\n    Shape.setMargin(0.05)\n\n    if (!addRigidBody) return Shape\n\n    this.addRigidBodyToShape(object, Shape, { mass, pos, quat, breakable, offset, config })\n  }\n\n  public addRigidBodyToShape(object: any, Shape: any, options: any) {\n    const {\n      mass = 1,\n      pos = new Vector3(0, 0, 0),\n      quat = new Quaternion(0, 0, 0, 1),\n      breakable = false,\n      offset = { x: 0, y: 0, z: 0 },\n      config = {}\n    } = options\n    this.addRigidBody(object, Shape, mass, pos, quat)\n    this.addBodyProperties(object, config)\n\n    if (breakable) object.body.breakable = true\n    if (offset) object.body.offset = { x: 0, y: 0, z: 0, ...offset }\n  }\n\n  private addShape(opts: any) {\n    const { shape, object, params, quat } = opts\n\n    let Shape\n    switch (shape) {\n      case 'plane':\n        Shape = createCollisionShapes(object, { type: 'mesh', concave: false })\n        break\n      case 'box':\n        Shape = new Ammo.btBoxShape(new Ammo.btVector3(params.width / 2, params.height / 2, params.depth / 2))\n        break\n      case 'sphere':\n        Shape = new Ammo.btSphereShape(params.radius)\n        break\n      case 'cylinder':\n        Shape = new Ammo.btCylinderShape(new Ammo.btVector3(params.radiusTop, params.height / 2, 0))\n        break\n      case 'cone':\n        Shape = new Ammo.btConeShape(params.radius, params.height)\n        break\n      case 'torus':\n        Shape = addTorusShape(params, quat)\n        break\n      case 'capsule':\n        Shape = new Ammo.btCapsuleShape(params.radius, params.height)\n        break\n      case 'hull':\n        Shape = createCollisionShapes(object, { type: 'hull' })\n        break\n      case 'hacd':\n        Shape = createCollisionShapes(object, { type: 'hacd' })\n        break\n      case 'vhacd':\n        Shape = createCollisionShapes(object, { type: 'vhacd' })\n        break\n      case 'convexMesh':\n        Shape = createCollisionShapes(object, { type: 'mesh', concave: false })\n        break\n      case 'concaveMesh':\n        Shape = createCollisionShapes(object, { type: 'mesh', concave: true })\n        break\n    }\n\n    if (Array.isArray(Shape)) {\n      const compoundShape = new Ammo.btCompoundShape()\n      Shape.forEach(shape => {\n        const transform = new Ammo.btTransform()\n        transform.setIdentity()\n        compoundShape.addChildShape(transform, shape)\n      })\n      Shape = compoundShape\n    }\n\n    return Shape\n  }\n\n  protected createRigidBody(physicsShape: any, mass: number, pos: Vector3, quat: Quaternion) {\n    const transform = new Ammo.btTransform()\n    transform.setIdentity()\n    transform.setOrigin(new Ammo.btVector3(pos.x, pos.y, pos.z))\n    transform.setRotation(new Ammo.btQuaternion(quat.x, quat.y, quat.z, quat.w))\n    const motionState = new Ammo.btDefaultMotionState(transform)\n    const localInertia = new Ammo.btVector3(0, 0, 0)\n    if (mass > 0) {\n      physicsShape.calculateLocalInertia(mass, localInertia)\n    }\n    const rbInfo = new Ammo.btRigidBodyConstructionInfo(mass, motionState, physicsShape, localInertia)\n    const rigidBody = new Ammo.btRigidBody(rbInfo)\n    return rigidBody\n  }\n\n  protected addRigidBody(\n    threeObject: ExtendedObject3D,\n    physicsShape: any,\n    mass: number,\n    pos: Vector3,\n    quat: Quaternion,\n    scale?: { x: number; y: number; z: number }\n  ) {\n    threeObject.position.copy(pos)\n    threeObject.quaternion.copy(quat)\n\n    const rigidBody = this.createRigidBody(physicsShape, mass, pos, quat)\n\n    if (scale) {\n      const localScale = new Ammo.btVector3(scale.x, scale.y, scale.z)\n      physicsShape.setLocalScaling(localScale)\n      Ammo.destroy(localScale)\n    }\n\n    if (mass > 0) {\n      // Disable deactivation\n      rigidBody.setActivationState(4)\n    }\n\n    this.rigidBodies.push(threeObject)\n    this.physicsWorld.addRigidBody(rigidBody)\n\n    const ptr = Object.values(rigidBody)[0]\n    // @ts-ignore\n    rigidBody.name = threeObject.name\n    threeObject.body = new PhysicsBody(this, rigidBody)\n    threeObject.hasBody = true\n    // @ts-ignore\n    threeObject.ptr = ptr\n    this.objectsAmmo[ptr] = threeObject\n  }\n\n  protected addBodyProperties(obj: ExtendedObject3D, config: any) {\n    const { friction = 0.5, collisionFlags = 0 } = config\n    obj.body.setCollisionFlags(collisionFlags)\n    obj.body.setFriction(friction)\n  }\n}\n\napplyMixins(AmmoPhysics, [Physics, Constraints, Shapes, Events])\n\nexport { AmmoPhysics }\n","/**\n * To create the UMD bundle\n */\nexport * from './index'\n\n// import * as THREE from '@enable3d/three-wrapper/dist/index'\n// export { THREE }\n"],"sourceRoot":""}